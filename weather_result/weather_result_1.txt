Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=1)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 31.724366188049316s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 26.398204565048218s
[]
mse:0.32611486315727234, mae:0.405626118183136
	iters: 200, cost time: 51.974910736083984s
[]
mse:0.2969144582748413, mae:0.3889365792274475
	iters: 300, cost time: 77.4345703125s
[]
mse:0.2632838487625122, mae:0.3692465126514435
	iters: 400, cost time: 102.36919069290161s
[]
mse:0.2493835687637329, mae:0.3633619248867035
	iters: 500, cost time: 126.53162407875061s
[]
mse:0.22982992231845856, mae:0.35004034638404846
	iters: 600, cost time: 154.0851113796234s
[]
mse:0.22099493443965912, mae:0.34071603417396545
	iters: 700, cost time: 183.97318172454834s
[]
mse:0.21748442947864532, mae:0.334300696849823
	iters: 800, cost time: 210.7859091758728s
[]
mse:0.20655804872512817, mae:0.3237954080104828
	iters: 900, cost time: 237.81883263587952s
[]
mse:0.20986050367355347, mae:0.317841112613678
	iters: 1000, cost time: 265.12255001068115s
[]
mse:0.22352004051208496, mae:0.3210712671279907
	iters: 1100, cost time: 291.2196047306061s
[]
mse:0.2254156768321991, mae:0.3217513859272003
	iters: 1200, cost time: 317.13392972946167s
[]
mse:0.21935221552848816, mae:0.31768926978111267
	iters: 1300, cost time: 344.617995262146s
[]
mse:0.21790291368961334, mae:0.31526732444763184
	iters: 1400, cost time: 368.65612626075745s
[]
mse:0.2282971739768982, mae:0.31617680191993713
	iters: 1500, cost time: 392.72601413726807s
[]
mse:0.2741069793701172, mae:0.33033373951911926
	iters: 1600, cost time: 416.84165716171265s
[]
mse:0.284517765045166, mae:0.33526432514190674
	iters: 1700, cost time: 441.0708944797516s
[]
mse:0.2770947217941284, mae:0.3321308493614197
	iters: 1800, cost time: 466.15577244758606s
[]
mse:0.27682358026504517, mae:0.331419974565506
	iters: 1900, cost time: 491.3763999938965s
[]
mse:0.2817580997943878, mae:0.3381507992744446
	iters: 2000, cost time: 519.5546934604645s
[]
mse:0.2786351144313812, mae:0.33786341547966003
	iters: 2100, cost time: 547.5732536315918s
[]
mse:0.28599467873573303, mae:0.34503230452537537
	iters: 2200, cost time: 575.223564863205s
[]
mse:0.27953076362609863, mae:0.34200337529182434
	iters: 2300, cost time: 602.9150273799896s
[]
mse:0.2802715599536896, mae:0.34503620862960815
	iters: 2400, cost time: 629.2028338909149s
[]
mse:0.28220808506011963, mae:0.34841498732566833
	iters: 2500, cost time: 654.1275873184204s
[]
mse:0.278719961643219, mae:0.3474820554256439
	iters: 2600, cost time: 681.231306552887s
[]
mse:0.2757641673088074, mae:0.3468465209007263
	iters: 2700, cost time: 706.6059973239899s
[]
mse:0.27622759342193604, mae:0.3489657938480377
	iters: 2800, cost time: 731.8366763591766s
[]
mse:0.27289193868637085, mae:0.34805718064308167
	iters: 2900, cost time: 756.56924700737s
[]
mse:0.2689015865325928, mae:0.3460983633995056
	iters: 3000, cost time: 782.1674027442932s
[]
mse:0.2690027952194214, mae:0.34723424911499023
	iters: 3100, cost time: 807.5389337539673s
[]
mse:0.26658788323402405, mae:0.34565967321395874
	iters: 3200, cost time: 836.2940208911896s
[]
mse:0.2658436894416809, mae:0.34521767497062683
	iters: 3300, cost time: 862.4901597499847s
[]
mse:0.26785001158714294, mae:0.34740349650382996
	iters: 3400, cost time: 887.6340997219086s
[]
mse:0.2658444046974182, mae:0.34617844223976135
	iters: 3500, cost time: 915.2904188632965s
[]
mse:0.2624967694282532, mae:0.3444293439388275
	iters: 3600, cost time: 944.0807998180389s
[]
mse:0.2622894048690796, mae:0.34562981128692627
	iters: 3700, cost time: 973.0813369750977s
[]
mse:0.25950583815574646, mae:0.3442419767379761
	iters: 3800, cost time: 1004.1647262573242s
[]
mse:0.2573229968547821, mae:0.34339749813079834
	iters: 3900, cost time: 1031.0622720718384s
[]
mse:0.25710493326187134, mae:0.34247103333473206
	iters: 4000, cost time: 1056.2161507606506s
[]
mse:0.2555416226387024, mae:0.34104442596435547
	iters: 4100, cost time: 1081.8502888679504s
[]
mse:0.2528609037399292, mae:0.3391530513763428
	iters: 4200, cost time: 1107.7954375743866s
[]
mse:0.24991212785243988, mae:0.33717450499534607
	iters: 4300, cost time: 1134.0932958126068s
[]
mse:0.2483300119638443, mae:0.33664628863334656
	iters: 4400, cost time: 1162.5756046772003s
[]
mse:0.24754810333251953, mae:0.33581483364105225
	iters: 4500, cost time: 1188.3956027030945s
[]
mse:0.24742212891578674, mae:0.33543798327445984
	iters: 4600, cost time: 1212.1388087272644s
[]
mse:0.24761971831321716, mae:0.33587655425071716
	iters: 4700, cost time: 1237.4863312244415s
[]
mse:0.24756844341754913, mae:0.3360821306705475
	iters: 4800, cost time: 1264.4428896903992s
[]
mse:0.2482590526342392, mae:0.3373759686946869
	iters: 4900, cost time: 1292.0749175548553s
[]
mse:0.2488510012626648, mae:0.33746838569641113
	iters: 5000, cost time: 1320.1140174865723s
[]
mse:0.24879047274589539, mae:0.3369862735271454
	iters: 5100, cost time: 1349.618145942688s
[]
mse:0.24935875833034515, mae:0.3381512463092804
	iters: 5200, cost time: 1381.274249792099s
[]
mse:0.24797141551971436, mae:0.3377326428890228
	iters: 5300, cost time: 1409.7560844421387s
[]
mse:0.24586424231529236, mae:0.3363494277000427
	iters: 5400, cost time: 1436.9523644447327s
[]
mse:0.24504496157169342, mae:0.3358859419822693
	iters: 5500, cost time: 1463.556053161621s
[]
mse:0.2431982308626175, mae:0.33442914485931396
	iters: 5600, cost time: 1489.2745039463043s
[]
mse:0.24211902916431427, mae:0.3335809111595154
	iters: 5700, cost time: 1517.5024423599243s
[]
mse:0.24082158505916595, mae:0.3325905501842499
	iters: 5800, cost time: 1545.2308313846588s
[]
mse:0.24068143963813782, mae:0.33230939507484436
	iters: 5900, cost time: 1571.2122576236725s
[]
mse:0.24009861052036285, mae:0.33171990513801575
	iters: 6000, cost time: 1597.279310464859s
[]
mse:0.23992568254470825, mae:0.33129051327705383
	iters: 6100, cost time: 1622.7519087791443s
[]
mse:0.2432010918855667, mae:0.3315471410751343
	iters: 6200, cost time: 1647.9227967262268s
[]
mse:0.24264195561408997, mae:0.3311164379119873
	iters: 6300, cost time: 1676.7862837314606s
[]
mse:0.24393786489963531, mae:0.3319112956523895
	iters: 6400, cost time: 1702.4318380355835s
[]
mse:0.24510884284973145, mae:0.3326880931854248
	iters: 6500, cost time: 1730.9037852287292s
[]
mse:0.24397604167461395, mae:0.33182787895202637
	iters: 6600, cost time: 1759.3637676239014s
[]
mse:0.24269510805606842, mae:0.3309425711631775
	iters: 6700, cost time: 1788.0382647514343s
[]
mse:0.2412206381559372, mae:0.32970958948135376
	iters: 6800, cost time: 1818.4937500953674s
[]
mse:0.24089260399341583, mae:0.32929062843322754
	iters: 6900, cost time: 1846.0834159851074s
[]
mse:0.24022766947746277, mae:0.32913827896118164
	iters: 7000, cost time: 1871.3189194202423s
[]
mse:0.23992784321308136, mae:0.3287089765071869
	iters: 7100, cost time: 1897.2533056735992s
[]
mse:0.2392105758190155, mae:0.32813793420791626
	iters: 7200, cost time: 1923.2311625480652s
[]
mse:0.2399977594614029, mae:0.3287055194377899
	iters: 7300, cost time: 1949.8817992210388s
[]
mse:0.24510356783866882, mae:0.3306540846824646
	iters: 7400, cost time: 1977.3223209381104s
[]
mse:0.24872608482837677, mae:0.33100131154060364
	iters: 7500, cost time: 2003.899284362793s
[]
mse:0.24989520013332367, mae:0.33171170949935913
	iters: 7600, cost time: 2029.965490102768s
[]
mse:0.25005748867988586, mae:0.332153856754303
	iters: 7700, cost time: 2055.1523282527924s
[]
mse:0.25020653009414673, mae:0.3312929570674896
	iters: 7800, cost time: 2083.2113122940063s
[]
mse:0.2494209259748459, mae:0.3309172987937927
	iters: 7900, cost time: 2112.171757698059s
[]
mse:0.24954864382743835, mae:0.3313603103160858
	iters: 8000, cost time: 2143.9803881645203s
[]
mse:0.24817641079425812, mae:0.3301815986633301
	iters: 8100, cost time: 2173.8643465042114s
[]
mse:0.24703504145145416, mae:0.3293951749801636
	iters: 8200, cost time: 2200.928153038025s
[]
mse:0.24787312746047974, mae:0.3292594254016876
	iters: 8300, cost time: 2226.037503004074s
[]
mse:0.24687030911445618, mae:0.32903555035591125
	iters: 8400, cost time: 2251.9780457019806s
[]
mse:0.24590153992176056, mae:0.3284860849380493
	iters: 8500, cost time: 2277.768154859543s
[]
mse:0.2447330206632614, mae:0.32796555757522583
	iters: 8600, cost time: 2306.72030544281s
[]
mse:0.24387812614440918, mae:0.3276916444301605
	iters: 8700, cost time: 2332.1865599155426s
[]
mse:0.24283362925052643, mae:0.32716500759124756
	iters: 8800, cost time: 2356.37042927742s
[]
mse:0.24168817698955536, mae:0.32649195194244385
	iters: 8900, cost time: 2381.3033752441406s
[]
mse:0.24181999266147614, mae:0.3262394368648529
	iters: 9000, cost time: 2406.599364042282s
[]
mse:0.2416253536939621, mae:0.3258500397205353
	iters: 9100, cost time: 2433.788018465042s
[]
mse:0.24467270076274872, mae:0.32745692133903503
	iters: 9200, cost time: 2461.330520629883s
[]
mse:0.2472495585680008, mae:0.3292892873287201
	iters: 9300, cost time: 2490.453544616699s
[]
mse:0.2506507337093353, mae:0.3295700252056122
	iters: 9400, cost time: 2519.7482063770294s
[]
mse:0.2535817325115204, mae:0.3309418559074402
	iters: 9500, cost time: 2547.7752475738525s
[]
mse:0.2552538514137268, mae:0.33201491832733154
	iters: 9600, cost time: 2573.633717775345s
[]
mse:0.2561723589897156, mae:0.3321288228034973
	iters: 9700, cost time: 2599.003403902054s
[]
mse:0.25522154569625854, mae:0.3315936326980591
	iters: 9800, cost time: 2624.21928358078s
[]
mse:0.2566525340080261, mae:0.33202776312828064
	iters: 9900, cost time: 2651.0115382671356s
[]
mse:0.2583067715167999, mae:0.33255764842033386
	iters: 10000, cost time: 2678.039099931717s
[]
mse:0.2597556412220001, mae:0.3333384394645691
	iters: 10100, cost time: 2703.7013640403748s
[]
mse:0.26181209087371826, mae:0.33364591002464294
	iters: 10200, cost time: 2729.13067984581s
[]
mse:0.2614835500717163, mae:0.3333791494369507
	iters: 10300, cost time: 2753.861112356186s
[]
mse:0.2600354552268982, mae:0.33247366547584534
	iters: 10400, cost time: 2785.4183688163757s
[]
mse:0.2588813900947571, mae:0.3317338228225708
[0.1847882504108669, 0.19301253474483887, 0.19365997666595428, 0.19597386158704944, 0.19954287589020986, 0.20349474815940338, 0.20823475271349254, 0.21354826053062134, 0.21909451948486666, 0.22534434394174363, 0.23143557597013073, 0.23595688691646666, 0.23833348767579385, 0.23798659846212677, 0.2370410687326247, 0.23633371594610575, 0.236585054568442, 0.23775916870441594, 0.23941949878065596, 0.24185907830768139, 0.2440618940390795, 0.24609727718619817, 0.24810905507164685, 0.2502103341668088, 0.2521521328825915, 0.25401014118556653, 0.2559159062388137, 0.2578032903459026, 0.2591696228443747, 0.26011870152679745, 0.2606085669127575, 0.26081393610814296, 0.2606359316829834, 0.260245862066607, 0.26007081532643267, 0.2599673324730693, 0.25974785644560694, 0.2594533537869238, 0.2594247812443395, 0.25944007309767186, 0.2597306823630006, 0.26024562618553415, 0.26080814155743554, 0.26134081581229013, 0.26212845749310204, 0.2626311003714008, 0.2631354802877103, 0.26370868049574014, 0.2643047866627038, 0.2649982716910126, 0.2653940304499747, 0.26572762973598024, 0.2659767364263777, 0.266157805465623, 0.2665661571232876, 0.26697965825657133, 0.2674617421308501, 0.2679769324008746, 0.2683508180448613, 0.26873729980375216, 0.2693043816262198, 0.26974680657865574, 0.27022114382139706, 0.27052487712130535, 0.2707388528267734, 0.2706709388595885, 0.27058031934271387, 0.27006691599459853, 0.2693519197560081, 0.2686307574571504, 0.26847280437670357, 0.2688258272760317, 0.2690629167785445, 0.2691030754357839, 0.269286899132897, 0.2696491878615084, 0.27009144934159657, 0.27048037771512057, 0.27108339156571326, 0.271751823089678, 0.27231303535612983, 0.27277339739712153, 0.27300876689522285, 0.273183767639708, 0.2738045858251279, 0.2747295610261125, 0.27586544122531215, 0.2775787702325624, 0.2800750783831434, 0.2835076205935886, 0.2875530258108577, 0.2922648314682393, 0.2969058937442531, 0.30336282884546745, 0.31202223774652793, 0.3138356983738519]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.2582314610481262, mae:0.33127981424331665
Test - cost time: 2801.159740924835s
