Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=200)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 28.021755933761597s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 23.682602167129517s
[]
mse:0.3272682726383209, mae:0.4065253436565399
	iters: 200, cost time: 46.415452003479004s
[]
mse:0.2973531186580658, mae:0.3882821500301361
	iters: 300, cost time: 69.00366115570068s
[]
mse:0.26349514722824097, mae:0.3685058057308197
	iters: 400, cost time: 91.66451406478882s
[]
mse:0.2491832673549652, mae:0.3625090718269348
	iters: 500, cost time: 114.22283029556274s
[]
mse:0.2299792617559433, mae:0.34940242767333984
	iters: 600, cost time: 136.7139811515808s
[]
mse:0.22111041843891144, mae:0.34010106325149536
	iters: 700, cost time: 159.14174365997314s
[]
mse:0.21784856915473938, mae:0.3340894877910614
	iters: 800, cost time: 182.18134760856628s
[]
mse:0.2070235162973404, mae:0.32370278239250183
	iters: 900, cost time: 207.19115924835205s
[]
mse:0.21035222709178925, mae:0.3176996409893036
	iters: 1000, cost time: 232.394278049469s
[]
mse:0.22433704137802124, mae:0.32125335931777954
	iters: 1100, cost time: 258.89644718170166s
[]
mse:0.22694189846515656, mae:0.32234838604927063
	iters: 1200, cost time: 284.1692416667938s
[]
mse:0.22073619067668915, mae:0.31825369596481323
	iters: 1300, cost time: 307.72331738471985s
[]
mse:0.21921277046203613, mae:0.31577035784721375
	iters: 1400, cost time: 331.19648933410645s
[]
mse:0.2295306921005249, mae:0.31691551208496094
	iters: 1500, cost time: 353.99015402793884s
[]
mse:0.27590039372444153, mae:0.331328809261322
	iters: 1600, cost time: 378.96526527404785s
[]
mse:0.2872972786426544, mae:0.33634665608406067
	iters: 1700, cost time: 404.4105110168457s
[]
mse:0.27991345524787903, mae:0.3332534432411194
	iters: 1800, cost time: 429.8650951385498s
[]
mse:0.27950724959373474, mae:0.3324599862098694
	iters: 1900, cost time: 455.1324200630188s
[]
mse:0.28445127606391907, mae:0.3392258286476135
	iters: 2000, cost time: 481.52604842185974s
[]
mse:0.2812548875808716, mae:0.338830828666687
	iters: 2100, cost time: 506.88886618614197s
[]
mse:0.28867700695991516, mae:0.34595000743865967
	iters: 2200, cost time: 533.316023349762s
[]
mse:0.28204116225242615, mae:0.3427653908729553
	iters: 2300, cost time: 560.898699760437s
[]
mse:0.2826080620288849, mae:0.3456922471523285
	iters: 2400, cost time: 589.1850304603577s
[]
mse:0.2843984365463257, mae:0.3489792048931122
	iters: 2500, cost time: 616.3837249279022s
[]
mse:0.28091856837272644, mae:0.3480958342552185
	iters: 2600, cost time: 641.5462827682495s
[]
mse:0.2778708338737488, mae:0.3474143147468567
	iters: 2700, cost time: 665.1489715576172s
[]
mse:0.2782994508743286, mae:0.3495251536369324
	iters: 2800, cost time: 689.0008859634399s
[]
mse:0.27489805221557617, mae:0.34857064485549927
	iters: 2900, cost time: 712.1820995807648s
[]
mse:0.27085793018341064, mae:0.3465794622898102
	iters: 3000, cost time: 735.8228139877319s
[]
mse:0.27095821499824524, mae:0.3477064371109009
	iters: 3100, cost time: 758.8500502109528s
[]
mse:0.2685146927833557, mae:0.3461091220378876
	iters: 3200, cost time: 782.908207654953s
[]
mse:0.2677145004272461, mae:0.34563499689102173
	iters: 3300, cost time: 807.3228874206543s
[]
mse:0.26969796419143677, mae:0.34779801964759827
	iters: 3400, cost time: 830.646235704422s
[]
mse:0.2676701247692108, mae:0.3465959429740906
	iters: 3500, cost time: 853.9387466907501s
[]
mse:0.26430270075798035, mae:0.34484413266181946
	iters: 3600, cost time: 877.7030885219574s
[]
mse:0.26407483220100403, mae:0.3460315763950348
	iters: 3700, cost time: 903.8253209590912s
[]
mse:0.26124340295791626, mae:0.344592809677124
	iters: 3800, cost time: 930.9665908813477s
[]
mse:0.2590697407722473, mae:0.3438001573085785
	iters: 3900, cost time: 956.9663310050964s
[]
mse:0.2588214874267578, mae:0.34286928176879883
	iters: 4000, cost time: 983.7363045215607s
[]
mse:0.257270485162735, mae:0.34146255254745483
	iters: 4100, cost time: 1009.1278946399689s
[]
mse:0.2545803487300873, mae:0.33956995606422424
	iters: 4200, cost time: 1035.2042260169983s
[]
mse:0.25161316990852356, mae:0.3375418782234192
	iters: 4300, cost time: 1061.9335317611694s
[]
mse:0.25000327825546265, mae:0.3369901478290558
	iters: 4400, cost time: 1088.9258766174316s
[]
mse:0.24916844069957733, mae:0.3361123502254486
	iters: 4500, cost time: 1115.3658311367035s
[]
mse:0.2490745633840561, mae:0.33575698733329773
	iters: 4600, cost time: 1141.5702378749847s
[]
mse:0.24918459355831146, mae:0.33614683151245117
	iters: 4700, cost time: 1168.227269411087s
[]
mse:0.24912753701210022, mae:0.3363456726074219
	iters: 4800, cost time: 1193.0138444900513s
[]
mse:0.2497890591621399, mae:0.3376069962978363
	iters: 4900, cost time: 1217.087106704712s
[]
mse:0.2503683269023895, mae:0.3376449942588806
	iters: 5000, cost time: 1240.4842839241028s
[]
mse:0.25032687187194824, mae:0.33717697858810425
	iters: 5100, cost time: 1264.0964958667755s
[]
mse:0.2509186565876007, mae:0.3383808732032776
	iters: 5200, cost time: 1287.9982013702393s
[]
mse:0.2495003193616867, mae:0.3379538953304291
	iters: 5300, cost time: 1312.773966550827s
[]
mse:0.24735184013843536, mae:0.33653271198272705
	iters: 5400, cost time: 1343.558270931244s
[]
mse:0.24651771783828735, mae:0.3360649645328522
	iters: 5500, cost time: 1367.9340000152588s
[]
mse:0.24463585019111633, mae:0.33458128571510315
	iters: 5600, cost time: 1391.271321773529s
[]
mse:0.24351955950260162, mae:0.33371084928512573
	iters: 5700, cost time: 1415.2415132522583s
[]
mse:0.24219337105751038, mae:0.33269667625427246
	iters: 5800, cost time: 1439.1956436634064s
[]
mse:0.2420511096715927, mae:0.33240413665771484
	iters: 5900, cost time: 1462.568894147873s
[]
mse:0.24149462580680847, mae:0.3318129777908325
	iters: 6000, cost time: 1486.2528071403503s
[]
mse:0.24131354689598083, mae:0.33136746287345886
	iters: 6100, cost time: 1510.5007112026215s
[]
mse:0.24456463754177094, mae:0.33161109685897827
	iters: 6200, cost time: 1534.459465265274s
[]
mse:0.24411626160144806, mae:0.33119526505470276
	iters: 6300, cost time: 1558.2946105003357s
[]
mse:0.24542976915836334, mae:0.33200711011886597
	iters: 6400, cost time: 1582.3593492507935s
[]
mse:0.24659523367881775, mae:0.3327748775482178
	iters: 6500, cost time: 1606.2137007713318s
[]
mse:0.24540965259075165, mae:0.3319103717803955
	iters: 6600, cost time: 1641.3066630363464s
[]
mse:0.24409736692905426, mae:0.331001877784729
	iters: 6700, cost time: 1668.8346877098083s
[]
mse:0.2426137924194336, mae:0.3297586739063263
	iters: 6800, cost time: 1701.1068437099457s
[]
mse:0.24225319921970367, mae:0.3293120861053467
	iters: 6900, cost time: 1727.1464993953705s
[]
mse:0.24159643054008484, mae:0.3291739523410797
	iters: 7000, cost time: 1753.0861535072327s
[]
mse:0.24129147827625275, mae:0.3287335932254791
	iters: 7100, cost time: 1784.2018728256226s
[]
mse:0.2405586838722229, mae:0.32813122868537903
	iters: 7200, cost time: 1807.399117231369s
[]
mse:0.2413681447505951, mae:0.3287069797515869
	iters: 7300, cost time: 1831.214144229889s
[]
mse:0.24646131694316864, mae:0.33064696192741394
	iters: 7400, cost time: 1856.8542749881744s
[]
mse:0.25011932849884033, mae:0.33099043369293213
	iters: 7500, cost time: 1880.4559009075165s
[]
mse:0.2514616847038269, mae:0.3317575752735138
	iters: 7600, cost time: 1903.539320230484s
[]
mse:0.2516340911388397, mae:0.3321979343891144
	iters: 7700, cost time: 1927.563711643219s
[]
mse:0.2517785429954529, mae:0.3313371241092682
	iters: 7800, cost time: 1951.657329082489s
[]
mse:0.2510102689266205, mae:0.3309728503227234
	iters: 7900, cost time: 1976.3129937648773s
[]
mse:0.25110551714897156, mae:0.33140212297439575
	iters: 8000, cost time: 2001.085485458374s
[]
mse:0.24971675872802734, mae:0.3302176892757416
	iters: 8100, cost time: 2026.0817098617554s
[]
mse:0.24854569137096405, mae:0.3294103145599365
	iters: 8200, cost time: 2050.2123346328735s
[]
mse:0.24937862157821655, mae:0.3292846977710724
	iters: 8300, cost time: 2074.506246805191s
[]
mse:0.2483963668346405, mae:0.32905733585357666
	iters: 8400, cost time: 2098.265471458435s
[]
mse:0.24742285907268524, mae:0.3285181224346161
	iters: 8500, cost time: 2125.436938762665s
[]
mse:0.24623703956604004, mae:0.3279808759689331
	iters: 8600, cost time: 2149.3297929763794s
[]
mse:0.24536919593811035, mae:0.32770171761512756
	iters: 8700, cost time: 2173.2517154216766s
[]
mse:0.2443147599697113, mae:0.32717493176460266
	iters: 8800, cost time: 2196.8378744125366s
[]
mse:0.24315135180950165, mae:0.32648777961730957
	iters: 8900, cost time: 2220.9193720817566s
[]
mse:0.24327291548252106, mae:0.32623517513275146
	iters: 9000, cost time: 2246.459718465805s
[]
mse:0.24307361245155334, mae:0.3258455991744995
	iters: 9100, cost time: 2272.92373752594s
[]
mse:0.2461484968662262, mae:0.3274814486503601
	iters: 9200, cost time: 2300.5994215011597s
[]
mse:0.24880445003509521, mae:0.3293842077255249
	iters: 9300, cost time: 2328.1881608963013s
[]
mse:0.25223007798194885, mae:0.3296810984611511
	iters: 9400, cost time: 2355.2728514671326s
[]
mse:0.2552134394645691, mae:0.33107954263687134
	iters: 9500, cost time: 2381.7610127925873s
[]
mse:0.2569659948348999, mae:0.33219465613365173
	iters: 9600, cost time: 2406.618318796158s
[]
mse:0.25792184472084045, mae:0.3323076665401459
	iters: 9700, cost time: 2431.331860780716s
[]
mse:0.25696414709091187, mae:0.3317628800868988
	iters: 9800, cost time: 2455.5270640850067s
[]
mse:0.25837278366088867, mae:0.3321850895881653
	iters: 9900, cost time: 2479.699789047241s
[]
mse:0.2599858045578003, mae:0.3326919376850128
	iters: 10000, cost time: 2504.401136159897s
[]
mse:0.26138773560523987, mae:0.333443820476532
	iters: 10100, cost time: 2528.7126970291138s
[]
mse:0.2634142339229584, mae:0.3337221145629883
	iters: 10200, cost time: 2552.8793103694916s
[]
mse:0.26312342286109924, mae:0.3334730565547943
	iters: 10300, cost time: 2577.144705057144s
[]
mse:0.2616627514362335, mae:0.3325587213039398
	iters: 10400, cost time: 2600.89453291893s
[]
mse:0.26048994064331055, mae:0.33180832862854004
[0.18467200734572858, 0.1930993192790669, 0.19391439727164483, 0.1963816494964957, 0.20019787748828274, 0.2043443727916073, 0.2092436039623241, 0.2147253027429864, 0.22039063819265867, 0.2266750253916389, 0.2326734727946774, 0.23716629972958375, 0.23942858868360423, 0.23903785486602963, 0.23801171538464252, 0.23744438238129303, 0.2377123052130547, 0.23901409148555608, 0.24090192853539114, 0.24364463278988277, 0.24609554036394152, 0.24827392904270884, 0.25034533486001004, 0.2524722123290125, 0.2543883559650559, 0.25616264777346853, 0.2579547712350284, 0.2596907221947767, 0.2607806555488782, 0.26141640519508746, 0.2616648745065596, 0.2616828669787127, 0.26149193745742083, 0.2612505244521502, 0.2612950111671031, 0.26145291112823293, 0.26144631508786315, 0.2614379653566075, 0.26163886617582893, 0.26176492820095454, 0.2622925851112235, 0.2627962102244274, 0.2632587467647885, 0.2635242563300245, 0.2640327559899088, 0.26433801791430583, 0.2647121053119306, 0.2650663192318492, 0.26543351328296483, 0.26598191888338046, 0.2662628180955008, 0.2665845975298534, 0.26702371924911916, 0.2676794211411751, 0.26841417343052704, 0.2690886144622788, 0.26972369896965825, 0.27023084635727895, 0.270655052783797, 0.27109556733182055, 0.2715598720866703, 0.2718949990443959, 0.27224370385131363, 0.27231567912534943, 0.2723848093249783, 0.2723773845299962, 0.2723521966425105, 0.27198013575697316, 0.2713402928453212, 0.27072342776080605, 0.2705382527400961, 0.2707595191997619, 0.27080769182506725, 0.2706353928985118, 0.27068509281539277, 0.27096634967228, 0.27138650584215107, 0.2717997263956491, 0.27249763700315655, 0.2732573797654686, 0.27409532533945, 0.2749736538683077, 0.2754833036389848, 0.27584430573007707, 0.2766033788205847, 0.27739643481915316, 0.2784358871012266, 0.28003956583366535, 0.28256708610701586, 0.28605534398185206, 0.2897574293884359, 0.29390274998086297, 0.2977619321474842, 0.30334127534869115, 0.3121137121007095, 0.31395572565902774]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.25983792543411255, mae:0.33135291934013367
Test - cost time: 2613.27140045166s
