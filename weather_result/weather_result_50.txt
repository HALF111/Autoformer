Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=50)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 31.963254928588867s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 23.35413146018982s
[]
mse:0.32602009177207947, mae:0.40551719069480896
	iters: 200, cost time: 48.76442527770996s
[]
mse:0.29662078619003296, mae:0.3883836269378662
	iters: 300, cost time: 72.45723247528076s
[]
mse:0.2628798484802246, mae:0.36862197518348694
	iters: 400, cost time: 97.62091088294983s
[]
mse:0.2489139586687088, mae:0.36275628209114075
	iters: 500, cost time: 121.8572587966919s
[]
mse:0.22948168218135834, mae:0.3494575321674347
	iters: 600, cost time: 146.49964237213135s
[]
mse:0.22062215209007263, mae:0.3401237726211548
	iters: 700, cost time: 170.85908889770508s
[]
mse:0.21717578172683716, mae:0.33382874727249146
	iters: 800, cost time: 195.0201394557953s
[]
mse:0.20630452036857605, mae:0.3233632743358612
	iters: 900, cost time: 217.0423080921173s
[]
mse:0.20962154865264893, mae:0.3173723816871643
	iters: 1000, cost time: 238.79564571380615s
[]
mse:0.22337161004543304, mae:0.3206935226917267
	iters: 1100, cost time: 260.4585642814636s
[]
mse:0.22544993460178375, mae:0.3214890956878662
	iters: 1200, cost time: 284.48972177505493s
[]
mse:0.2193477898836136, mae:0.3174131214618683
	iters: 1300, cost time: 307.0582945346832s
[]
mse:0.21788346767425537, mae:0.3149664103984833
	iters: 1400, cost time: 329.9738471508026s
[]
mse:0.22827309370040894, mae:0.3159518837928772
	iters: 1500, cost time: 351.7340705394745s
[]
mse:0.27418252825737, mae:0.33016178011894226
	iters: 1600, cost time: 374.2316789627075s
[]
mse:0.2849397659301758, mae:0.33513832092285156
	iters: 1700, cost time: 397.27818965911865s
[]
mse:0.2775043547153473, mae:0.3319801092147827
	iters: 1800, cost time: 420.64124941825867s
[]
mse:0.2771790027618408, mae:0.33123111724853516
	iters: 1900, cost time: 442.8447437286377s
[]
mse:0.2820959687232971, mae:0.3379620611667633
	iters: 2000, cost time: 465.3019850254059s
[]
mse:0.2789486348628998, mae:0.3376322090625763
	iters: 2100, cost time: 487.217134475708s
[]
mse:0.2863355278968811, mae:0.34478068351745605
	iters: 2200, cost time: 509.6909532546997s
[]
mse:0.27982667088508606, mae:0.34169673919677734
	iters: 2300, cost time: 532.0321750640869s
[]
mse:0.28053346276283264, mae:0.34471285343170166
	iters: 2400, cost time: 555.6142416000366s
[]
mse:0.2824305593967438, mae:0.34807711839675903
	iters: 2500, cost time: 578.4682893753052s
[]
mse:0.27895215153694153, mae:0.34717032313346863
	iters: 2600, cost time: 601.6645448207855s
[]
mse:0.2759760022163391, mae:0.3465310335159302
	iters: 2700, cost time: 627.6993916034698s
[]
mse:0.2764272391796112, mae:0.34865090250968933
	iters: 2800, cost time: 654.4745745658875s
[]
mse:0.2730715870857239, mae:0.3477339446544647
	iters: 2900, cost time: 680.1082952022552s
[]
mse:0.26906701922416687, mae:0.3457624614238739
	iters: 3000, cost time: 705.4815657138824s
[]
mse:0.2691657245159149, mae:0.34689149260520935
	iters: 3100, cost time: 731.0475871562958s
[]
mse:0.2667433023452759, mae:0.34530752897262573
	iters: 3200, cost time: 758.0108344554901s
[]
mse:0.26597899198532104, mae:0.3448537588119507
	iters: 3300, cost time: 782.7203943729401s
[]
mse:0.26798614859580994, mae:0.3470398485660553
	iters: 3400, cost time: 807.5125398635864s
[]
mse:0.2659756541252136, mae:0.3458201587200165
	iters: 3500, cost time: 832.3466651439667s
[]
mse:0.26262253522872925, mae:0.34406352043151855
	iters: 3600, cost time: 858.3699717521667s
[]
mse:0.2624102234840393, mae:0.3452630937099457
	iters: 3700, cost time: 885.6102523803711s
[]
mse:0.25961169600486755, mae:0.3438493609428406
	iters: 3800, cost time: 911.7987344264984s
[]
mse:0.25743260979652405, mae:0.3430238962173462
	iters: 3900, cost time: 938.859885931015s
[]
mse:0.25721240043640137, mae:0.3421024978160858
	iters: 4000, cost time: 964.2552092075348s
[]
mse:0.25564855337142944, mae:0.3406738042831421
	iters: 4100, cost time: 991.9051785469055s
[]
mse:0.2529665529727936, mae:0.33878064155578613
	iters: 4200, cost time: 1017.2275166511536s
[]
mse:0.25001901388168335, mae:0.33678582310676575
	iters: 4300, cost time: 1043.5250239372253s
[]
mse:0.24843141436576843, mae:0.33624267578125
	iters: 4400, cost time: 1071.2033014297485s
[]
mse:0.24764010310173035, mae:0.33539676666259766
	iters: 4500, cost time: 1099.5400650501251s
[]
mse:0.24753066897392273, mae:0.33502259850502014
	iters: 4600, cost time: 1125.5713667869568s
[]
mse:0.24770207703113556, mae:0.3354545831680298
	iters: 4700, cost time: 1152.8377859592438s
[]
mse:0.2476511001586914, mae:0.335659921169281
	iters: 4800, cost time: 1180.0306034088135s
[]
mse:0.24833503365516663, mae:0.3369472324848175
	iters: 4900, cost time: 1208.1536955833435s
[]
mse:0.24892203509807587, mae:0.33702078461647034
	iters: 5000, cost time: 1238.4240074157715s
[]
mse:0.24887080490589142, mae:0.33654364943504333
	iters: 5100, cost time: 1269.0332362651825s
[]
mse:0.24944446980953217, mae:0.3377186059951782
	iters: 5200, cost time: 1301.514174938202s
[]
mse:0.24804608523845673, mae:0.33729565143585205
	iters: 5300, cost time: 1328.4127821922302s
[]
mse:0.24592460691928864, mae:0.3358939290046692
	iters: 5400, cost time: 1356.0041735172272s
[]
mse:0.24509969353675842, mae:0.33542943000793457
	iters: 5500, cost time: 1386.8026101589203s
[]
mse:0.243241548538208, mae:0.33396244049072266
	iters: 5600, cost time: 1415.9978723526s
[]
mse:0.2421482801437378, mae:0.3331014811992645
	iters: 5700, cost time: 1445.443775177002s
[]
mse:0.24084116518497467, mae:0.33210429549217224
	iters: 5800, cost time: 1469.9218757152557s
[]
mse:0.2406996339559555, mae:0.3318173885345459
	iters: 5900, cost time: 1499.1212825775146s
[]
mse:0.24013540148735046, mae:0.3312312662601471
	iters: 6000, cost time: 1529.4115250110626s
[]
mse:0.23995868861675262, mae:0.33079853653907776
	iters: 6100, cost time: 1557.6087317466736s
[]
mse:0.2432265281677246, mae:0.33105361461639404
	iters: 6200, cost time: 1586.423679113388s
[]
mse:0.24268589913845062, mae:0.3306244909763336
	iters: 6300, cost time: 1615.3552663326263s
[]
mse:0.24398723244667053, mae:0.3314239978790283
	iters: 6400, cost time: 1644.8601908683777s
[]
mse:0.24515415728092194, mae:0.3321980834007263
	iters: 6500, cost time: 1674.0417726039886s
[]
mse:0.244004026055336, mae:0.3313353657722473
	iters: 6600, cost time: 1703.2901048660278s
[]
mse:0.24271702766418457, mae:0.3304455876350403
	iters: 6700, cost time: 1730.4497261047363s
[]
mse:0.24124188721179962, mae:0.32920873165130615
	iters: 6800, cost time: 1759.9051654338837s
[]
mse:0.24090418219566345, mae:0.32878169417381287
	iters: 6900, cost time: 1788.2530376911163s
[]
mse:0.24023473262786865, mae:0.3286318778991699
	iters: 7000, cost time: 1818.2354083061218s
[]
mse:0.23993384838104248, mae:0.32819828391075134
	iters: 7100, cost time: 1848.2137014865875s
[]
mse:0.23921099305152893, mae:0.32761502265930176
	iters: 7200, cost time: 1879.6456468105316s
[]
mse:0.2399994283914566, mae:0.3281821608543396
	iters: 7300, cost time: 1911.3554620742798s
[]
mse:0.24510706961154938, mae:0.33013084530830383
	iters: 7400, cost time: 1941.4998919963837s
[]
mse:0.24872161448001862, mae:0.3304709196090698
	iters: 7500, cost time: 1971.9316356182098s
[]
mse:0.24992065131664276, mae:0.3311878740787506
	iters: 7600, cost time: 2002.930918931961s
[]
mse:0.25008487701416016, mae:0.3316330015659332
	iters: 7700, cost time: 2033.9416167736053s
[]
mse:0.25023171305656433, mae:0.33076921105384827
	iters: 7800, cost time: 2064.5099120140076s
[]
mse:0.24945199489593506, mae:0.33039745688438416
	iters: 7900, cost time: 2094.6605598926544s
[]
mse:0.24957375228405, mae:0.33083686232566833
	iters: 8000, cost time: 2126.4680750370026s
[]
mse:0.2481973022222519, mae:0.32965287566185
	iters: 8100, cost time: 2157.8083045482635s
[]
mse:0.2470502257347107, mae:0.3288611173629761
	iters: 8200, cost time: 2187.786093711853s
[]
mse:0.24788637459278107, mae:0.32873106002807617
	iters: 8300, cost time: 2219.7784118652344s
[]
mse:0.24689047038555145, mae:0.32850757241249084
	iters: 8400, cost time: 2250.579606294632s
[]
mse:0.24592188000679016, mae:0.32796308398246765
	iters: 8500, cost time: 2281.850989341736s
[]
mse:0.24474941194057465, mae:0.32743561267852783
	iters: 8600, cost time: 2312.804065465927s
[]
mse:0.24389232695102692, mae:0.3271608054637909
	iters: 8700, cost time: 2344.3700983524323s
[]
mse:0.2428465336561203, mae:0.3266356289386749
	iters: 8800, cost time: 2373.9626104831696s
[]
mse:0.2416977882385254, mae:0.32595887780189514
	iters: 8900, cost time: 2404.915753364563s
[]
mse:0.24182835221290588, mae:0.3257060647010803
	iters: 9000, cost time: 2436.359971523285s
[]
mse:0.24163296818733215, mae:0.32531705498695374
	iters: 9100, cost time: 2469.786304473877s
[]
mse:0.24469515681266785, mae:0.3269312381744385
	iters: 9200, cost time: 2500.7968039512634s
[]
mse:0.24729087948799133, mae:0.3287799060344696
	iters: 9300, cost time: 2533.835382938385s
[]
mse:0.2507011592388153, mae:0.32906535267829895
	iters: 9400, cost time: 2568.5816802978516s
[]
mse:0.2536410391330719, mae:0.3304423689842224
	iters: 9500, cost time: 2600.474070072174s
[]
mse:0.25532078742980957, mae:0.3315231204032898
	iters: 9600, cost time: 2630.9335737228394s
[]
mse:0.25625064969062805, mae:0.33163541555404663
	iters: 9700, cost time: 2662.8629405498505s
[]
mse:0.255296528339386, mae:0.3310970067977905
	iters: 9800, cost time: 2696.62646818161s
[]
mse:0.25672081112861633, mae:0.331527441740036
	iters: 9900, cost time: 2728.486207962036s
[]
mse:0.2583690285682678, mae:0.3320517838001251
	iters: 10000, cost time: 2761.84055018425s
[]
mse:0.2598085403442383, mae:0.33282625675201416
	iters: 10100, cost time: 2795.8977706432343s
[]
mse:0.2618580758571625, mae:0.3331274390220642
	iters: 10200, cost time: 2827.253807783127s
[]
mse:0.2615359127521515, mae:0.3328647017478943
	iters: 10300, cost time: 2860.426369667053s
[]
mse:0.2600879967212677, mae:0.33195894956588745
	iters: 10400, cost time: 2893.434361219406s
[]
mse:0.2589312493801117, mae:0.3312187194824219
[0.1843747070671085, 0.1926765826716056, 0.1933567207654398, 0.19567375172312862, 0.19932125431842343, 0.20332399581668506, 0.20804212698395488, 0.21340917557728883, 0.21899190637902244, 0.225273786356688, 0.2313882900900516, 0.2359247780463839, 0.23830303451435497, 0.23794816558659312, 0.23699148615159818, 0.2363493470796992, 0.2365594444181506, 0.23772597826195757, 0.23942211190237167, 0.2418902946094979, 0.24416681349385216, 0.24623404127221601, 0.24823517398150763, 0.2503266182997593, 0.2522629907008543, 0.2541259309119637, 0.25603403406979586, 0.2579323764369127, 0.2592759705367111, 0.26016871272384756, 0.26059078538079816, 0.2607310697797394, 0.26054380009823297, 0.2602072227723955, 0.26008704031674224, 0.2600276552791943, 0.2598211011080316, 0.2595281666169697, 0.2595380842629075, 0.25953689404875285, 0.2599059511097797, 0.2604059676115577, 0.2609422779928291, 0.2614210497544492, 0.26216883143557757, 0.2626425600632075, 0.2631663392290433, 0.26371518177813996, 0.26427799276236236, 0.2649491640892699, 0.26530876680983, 0.2656479230308773, 0.2659686626407219, 0.2662793981611025, 0.26677282699545196, 0.26723654284295334, 0.26771390472638823, 0.2681888989254023, 0.26855916327613893, 0.26895477307846427, 0.2694739430955722, 0.2699104660055634, 0.2703659331583147, 0.2706172343715169, 0.27079414512943556, 0.2707652888568295, 0.2706877720715783, 0.2702216684022131, 0.2695688238594027, 0.268904780130441, 0.26874849541464657, 0.26904626343937355, 0.269204994659405, 0.269137599662919, 0.26923083855645863, 0.26956326655621027, 0.2700092065604978, 0.2704268781778505, 0.271085596362538, 0.271841262088265, 0.2725127139694101, 0.2731322999302157, 0.2734619607732138, 0.273687028447414, 0.27433591641228694, 0.2751857425644958, 0.2762916354438071, 0.27797018939161755, 0.2804310435708951, 0.28384423636024686, 0.2878202837273462, 0.29229247069425207, 0.29654792281922077, 0.30262389441852056, 0.3113939962507668, 0.3133090785110215]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.25828102231025696, mae:0.33076316118240356
Test - cost time: 2922.677919626236s
