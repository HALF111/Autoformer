Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=5)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 36.59298658370972s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 27.338730812072754s
[]
mse:0.3260674774646759, mae:0.40557941794395447
	iters: 200, cost time: 54.15804314613342s
[]
mse:0.29684826731681824, mae:0.388846755027771
	iters: 300, cost time: 77.480477809906s
[]
mse:0.2632025480270386, mae:0.3691444993019104
	iters: 400, cost time: 101.03726840019226s
[]
mse:0.24930010735988617, mae:0.3632661998271942
	iters: 500, cost time: 126.26710057258606s
[]
mse:0.22975116968154907, mae:0.34993457794189453
	iters: 600, cost time: 150.52712535858154s
[]
mse:0.22091326117515564, mae:0.34060922265052795
	iters: 700, cost time: 174.53204798698425s
[]
mse:0.2174016535282135, mae:0.3341938853263855
	iters: 800, cost time: 198.88369369506836s
[]
mse:0.20648212730884552, mae:0.32369300723075867
	iters: 900, cost time: 222.55133318901062s
[]
mse:0.20978772640228271, mae:0.31773585081100464
	iters: 1000, cost time: 245.88788485527039s
[]
mse:0.2234550267457962, mae:0.32097432017326355
	iters: 1100, cost time: 272.00820803642273s
[]
mse:0.22536037862300873, mae:0.32166215777397156
	iters: 1200, cost time: 295.71777176856995s
[]
mse:0.21929532289505005, mae:0.3176000714302063
	iters: 1300, cost time: 323.2351019382477s
[]
mse:0.21784593164920807, mae:0.3151763677597046
	iters: 1400, cost time: 349.3772711753845s
[]
mse:0.2282404750585556, mae:0.31609228253364563
	iters: 1500, cost time: 375.3739993572235s
[]
mse:0.27404671907424927, mae:0.3302517235279083
	iters: 1600, cost time: 403.0106613636017s
[]
mse:0.284487783908844, mae:0.335188090801239
	iters: 1700, cost time: 431.501273393631s
[]
mse:0.27706149220466614, mae:0.3320479989051819
	iters: 1800, cost time: 456.2472577095032s
[]
mse:0.276784211397171, mae:0.331331342458725
	iters: 1900, cost time: 479.98077487945557s
[]
mse:0.2817135751247406, mae:0.3380609154701233
	iters: 2000, cost time: 504.85381627082825s
[]
mse:0.27858883142471313, mae:0.3377698063850403
	iters: 2100, cost time: 529.07568526268s
[]
mse:0.2859521508216858, mae:0.3449368178844452
	iters: 2200, cost time: 553.0186195373535s
[]
mse:0.2794843912124634, mae:0.34190040826797485
	iters: 2300, cost time: 576.5701079368591s
[]
mse:0.2802242040634155, mae:0.34493300318717957
	iters: 2400, cost time: 603.9508616924286s
[]
mse:0.28215786814689636, mae:0.34831181168556213
	iters: 2500, cost time: 627.4359567165375s
[]
mse:0.27867183089256287, mae:0.34738266468048096
	iters: 2600, cost time: 650.842334985733s
[]
mse:0.2757156491279602, mae:0.3467486500740051
	iters: 2700, cost time: 676.1172137260437s
[]
mse:0.2761785387992859, mae:0.34886905550956726
	iters: 2800, cost time: 703.6502521038055s
[]
mse:0.27284201979637146, mae:0.3479609191417694
	iters: 2900, cost time: 731.8369355201721s
[]
mse:0.26885178685188293, mae:0.34600216150283813
	iters: 3000, cost time: 761.0249209403992s
[]
mse:0.26895368099212646, mae:0.34713852405548096
	iters: 3100, cost time: 788.4800956249237s
[]
mse:0.26653897762298584, mae:0.34556347131729126
	iters: 3200, cost time: 815.2043778896332s
[]
mse:0.2657936215400696, mae:0.34512093663215637
	iters: 3300, cost time: 842.4150879383087s
[]
mse:0.267799973487854, mae:0.34730714559555054
	iters: 3400, cost time: 867.8164129257202s
[]
mse:0.2657948434352875, mae:0.34608277678489685
	iters: 3500, cost time: 895.9370601177216s
[]
mse:0.2624475657939911, mae:0.3443334996700287
	iters: 3600, cost time: 920.9978983402252s
[]
mse:0.2622404992580414, mae:0.3455345332622528
	iters: 3700, cost time: 945.7076048851013s
[]
mse:0.25945624709129333, mae:0.34414413571357727
	iters: 3800, cost time: 969.8150024414062s
[]
mse:0.257273405790329, mae:0.34330055117607117
	iters: 3900, cost time: 994.6025409698486s
[]
mse:0.2570560574531555, mae:0.3423752188682556
	iters: 4000, cost time: 1019.3611514568329s
[]
mse:0.25549250841140747, mae:0.34094810485839844
	iters: 4100, cost time: 1047.5813541412354s
[]
mse:0.25281208753585815, mae:0.3390566408634186
	iters: 4200, cost time: 1073.087900876999s
[]
mse:0.2498638927936554, mae:0.3370763957500458
	iters: 4300, cost time: 1099.1630129814148s
[]
mse:0.24828144907951355, mae:0.3365454077720642
	iters: 4400, cost time: 1126.2150053977966s
[]
mse:0.2474995255470276, mae:0.3357127010822296
	iters: 4500, cost time: 1153.92143201828s
[]
mse:0.24737568199634552, mae:0.33533552289009094
	iters: 4600, cost time: 1183.3890542984009s
[]
mse:0.24757009744644165, mae:0.3357730507850647
	iters: 4700, cost time: 1214.1242218017578s
[]
mse:0.2475191354751587, mae:0.3359789252281189
	iters: 4800, cost time: 1243.8772559165955s
[]
mse:0.24820968508720398, mae:0.33727291226387024
	iters: 4900, cost time: 1269.0767376422882s
[]
mse:0.24880170822143555, mae:0.3373640179634094
	iters: 5000, cost time: 1294.2527515888214s
[]
mse:0.24874231219291687, mae:0.33688274025917053
	iters: 5100, cost time: 1319.332575082779s
[]
mse:0.24931137263774872, mae:0.3380487859249115
	iters: 5200, cost time: 1344.8558185100555s
[]
mse:0.24792349338531494, mae:0.3376302421092987
	iters: 5300, cost time: 1370.5669062137604s
[]
mse:0.245815247297287, mae:0.3362451493740082
	iters: 5400, cost time: 1396.7378842830658s
[]
mse:0.24499547481536865, mae:0.3357815742492676
	iters: 5500, cost time: 1424.3025047779083s
[]
mse:0.24314813315868378, mae:0.3343241512775421
	iters: 5600, cost time: 1449.1725161075592s
[]
mse:0.2420678287744522, mae:0.3334745168685913
	iters: 5700, cost time: 1473.895363330841s
[]
mse:0.24076980352401733, mae:0.33248403668403625
	iters: 5800, cost time: 1501.4188277721405s
[]
mse:0.24062998592853546, mae:0.33220261335372925
	iters: 5900, cost time: 1528.8954937458038s
[]
mse:0.24004901945590973, mae:0.331613689661026
	iters: 6000, cost time: 1558.5326721668243s
[]
mse:0.23987555503845215, mae:0.3311842083930969
	iters: 6100, cost time: 1588.8734755516052s
[]
mse:0.2431504726409912, mae:0.33144107460975647
	iters: 6200, cost time: 1616.168386220932s
[]
mse:0.24259218573570251, mae:0.3310108780860901
	iters: 6300, cost time: 1640.9957559108734s
[]
mse:0.2438887655735016, mae:0.3318062126636505
	iters: 6400, cost time: 1666.497570514679s
[]
mse:0.2450595498085022, mae:0.33258309960365295
	iters: 6500, cost time: 1691.1443514823914s
[]
mse:0.2439247965812683, mae:0.33172228932380676
	iters: 6600, cost time: 1718.9748089313507s
[]
mse:0.24264338612556458, mae:0.330836683511734
	iters: 6700, cost time: 1745.1783912181854s
[]
mse:0.24116913974285126, mae:0.3296034634113312
	iters: 6800, cost time: 1770.677612066269s
[]
mse:0.24084053933620453, mae:0.3291841149330139
	iters: 6900, cost time: 1795.8676760196686s
[]
mse:0.2401745617389679, mae:0.3290320634841919
	iters: 7000, cost time: 1820.7690563201904s
[]
mse:0.23987489938735962, mae:0.3286025822162628
	iters: 7100, cost time: 1847.2782394886017s
[]
mse:0.23915746808052063, mae:0.3280307948589325
	iters: 7200, cost time: 1877.3503515720367s
[]
mse:0.23994457721710205, mae:0.3285984396934509
	iters: 7300, cost time: 1905.5496263504028s
[]
mse:0.2450508028268814, mae:0.3305472731590271
	iters: 7400, cost time: 1933.3820431232452s
[]
mse:0.24867035448551178, mae:0.33089369535446167
	iters: 7500, cost time: 1961.272054195404s
[]
mse:0.24984024465084076, mae:0.3316034972667694
	iters: 7600, cost time: 1988.791003704071s
[]
mse:0.2500028908252716, mae:0.332046240568161
	iters: 7700, cost time: 2016.3800160884857s
[]
mse:0.25015199184417725, mae:0.3311849534511566
	iters: 7800, cost time: 2044.511680841446s
[]
mse:0.24936671555042267, mae:0.3308098316192627
	iters: 7900, cost time: 2068.6830077171326s
[]
mse:0.2494940310716629, mae:0.3312520682811737
	iters: 8000, cost time: 2093.6019768714905s
[]
mse:0.24812166392803192, mae:0.33007270097732544
	iters: 8100, cost time: 2118.340299129486s
[]
mse:0.24698011577129364, mae:0.3292858600616455
	iters: 8200, cost time: 2143.7873005867004s
[]
mse:0.24781790375709534, mae:0.3291504383087158
	iters: 8300, cost time: 2168.8004035949707s
[]
mse:0.24681520462036133, mae:0.3289267122745514
	iters: 8400, cost time: 2194.8499052524567s
[]
mse:0.24584682285785675, mae:0.32837817072868347
	iters: 8500, cost time: 2223.802711248398s
[]
mse:0.24467812478542328, mae:0.32785677909851074
	iters: 8600, cost time: 2252.4278841018677s
[]
mse:0.24382330477237701, mae:0.3275829553604126
	iters: 8700, cost time: 2280.099056959152s
[]
mse:0.24277886748313904, mae:0.32705655694007874
	iters: 8800, cost time: 2307.3751015663147s
[]
mse:0.24163348972797394, mae:0.3263833522796631
	iters: 8900, cost time: 2336.049562215805s
[]
mse:0.24176551401615143, mae:0.3261307179927826
	iters: 9000, cost time: 2365.7272865772247s
[]
mse:0.24157115817070007, mae:0.3257416784763336
	iters: 9100, cost time: 2394.9377241134644s
[]
mse:0.24462012946605682, mae:0.3273491859436035
	iters: 9200, cost time: 2421.257905960083s
[]
mse:0.24719534814357758, mae:0.32918059825897217
	iters: 9300, cost time: 2447.2469210624695s
[]
mse:0.25059717893600464, mae:0.32946160435676575
	iters: 9400, cost time: 2472.6283860206604s
[]
mse:0.2535276710987091, mae:0.3308330774307251
	iters: 9500, cost time: 2497.8944249153137s
[]
mse:0.25519925355911255, mae:0.33190590143203735
	iters: 9600, cost time: 2527.016045331955s
[]
mse:0.25611844658851624, mae:0.33201950788497925
	iters: 9700, cost time: 2552.9084787368774s
[]
mse:0.2551673650741577, mae:0.33148398995399475
	iters: 9800, cost time: 2578.6541731357574s
[]
mse:0.2565978169441223, mae:0.331917941570282
	iters: 9900, cost time: 2604.6556203365326s
[]
mse:0.25825193524360657, mae:0.3324473798274994
	iters: 10000, cost time: 2629.9625210762024s
[]
mse:0.2596999406814575, mae:0.3332275152206421
	iters: 10100, cost time: 2655.9049503803253s
[]
mse:0.26175615191459656, mae:0.33353468775749207
	iters: 10200, cost time: 2687.314962387085s
[]
mse:0.26142802834510803, mae:0.3332683742046356
	iters: 10300, cost time: 2718.235687971115s
[]
mse:0.25998005270957947, mae:0.3323630094528198
	iters: 10400, cost time: 2745.583507299423s
[]
mse:0.25882595777511597, mae:0.3316231369972229
[0.18470181953831644, 0.19293551139908224, 0.19358748215635363, 0.19590004454508647, 0.19947240783919287, 0.20342646373893492, 0.20816271734574282, 0.2134806141478881, 0.2190278548040516, 0.2252806765477668, 0.23137419292285408, 0.23589719773365783, 0.23827185812966248, 0.2379231622965335, 0.23697521459453566, 0.23627326744781577, 0.2365207443600902, 0.2376945854268279, 0.23935798094053234, 0.24180012077417, 0.24400923388873874, 0.24604948772825885, 0.2480596754568326, 0.2501580395185781, 0.2520989435606314, 0.2539563239254243, 0.25586387718565246, 0.2577515906672668, 0.2591159592275781, 0.2600660803943604, 0.2605488760793569, 0.26074576778112646, 0.26056492914131274, 0.2601800270464909, 0.26001225660689004, 0.25991161772713767, 0.25969144428085195, 0.2593961074871711, 0.2593692892562949, 0.25938291370755256, 0.2596805299425727, 0.26019533418023716, 0.2607535011552282, 0.2612814708431481, 0.26206423687140096, 0.26256541579764525, 0.2630713545001775, 0.263647631160853, 0.26424546209736455, 0.2649397598010602, 0.26533417796897296, 0.26566870648256774, 0.2659241652258143, 0.2661192156679426, 0.2665374481175127, 0.26695468621419427, 0.2674326248161462, 0.2679400221991386, 0.2683098356547412, 0.26869633639097923, 0.2692545048576112, 0.26969106256914027, 0.2701618657297141, 0.27045930719994415, 0.2706708576572709, 0.2706059967773383, 0.27052013204750125, 0.2700118783185289, 0.26930653491379014, 0.2685930198463331, 0.26843858179361646, 0.26879147718807134, 0.2690226407148256, 0.26905479215648903, 0.2692282107967312, 0.2695875299193571, 0.2700308806017952, 0.27041522831918563, 0.2710201001779327, 0.2716947019871357, 0.272268150582102, 0.2727434990820302, 0.2729933364978039, 0.27317531041725, 0.27379682177619075, 0.27471373992803894, 0.2758456364761623, 0.27755625265832723, 0.2800521544260264, 0.28348526691201803, 0.28752453810557127, 0.29221247296047526, 0.29681345226303063, 0.30322537557071244, 0.31189845125816906, 0.31371821570293984]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.2581760883331299, mae:0.33116891980171204
Test - cost time: 2759.7034180164337s
