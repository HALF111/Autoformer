Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=1000)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 38.80907654762268s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 25.919630527496338s
[]
mse:0.3397252559661865, mae:0.4163859486579895
	iters: 200, cost time: 50.726303577423096s
[]
mse:0.30993467569351196, mae:0.3946968913078308
	iters: 300, cost time: 74.11458158493042s
[]
mse:0.2876379191875458, mae:0.37957021594047546
	iters: 400, cost time: 98.91793513298035s
[]
mse:0.37088724970817566, mae:0.39570096135139465
	iters: 500, cost time: 121.29664325714111s
[]
mse:1.5847735404968262, mae:0.546570360660553
	iters: 600, cost time: 143.44002389907837s
[]
mse:7.816106796264648, mae:0.8933688998222351
	iters: 700, cost time: 167.51929688453674s
[]
mse:9.140738487243652, mae:1.0338847637176514
	iters: 800, cost time: 192.26853823661804s
[]
mse:8.331419944763184, mae:0.9868032336235046
	iters: 900, cost time: 216.60841536521912s
[]
mse:7.437605857849121, mae:0.9120874404907227
	iters: 1000, cost time: 241.31365609169006s
[]
mse:6.731954574584961, mae:0.8578163385391235
	iters: 1100, cost time: 264.9801187515259s
[]
mse:6.163512229919434, mae:0.8205114006996155
	iters: 1200, cost time: 287.9312114715576s
[]
mse:5.671702861785889, mae:0.7810584306716919
	iters: 1300, cost time: 311.582909822464s
[]
mse:5.258044242858887, mae:0.7469808459281921
	iters: 1400, cost time: 333.01823568344116s
[]
mse:9.481644630432129, mae:0.8304722309112549
	iters: 1500, cost time: 355.7812693119049s
[]
mse:9.576851844787598, mae:0.8447853922843933
	iters: 1600, cost time: 380.05173087120056s
[]
mse:9.152270317077637, mae:0.8369265198707581
	iters: 1700, cost time: 403.46778178215027s
[]
mse:8.624316215515137, mae:0.804993212223053
	iters: 1800, cost time: 427.3337519168854s
[]
mse:10.014801979064941, mae:0.9271916747093201
	iters: 1900, cost time: 450.5896592140198s
[]
mse:49.29914855957031, mae:1.1993353366851807
	iters: 2000, cost time: 474.4614636898041s
[]
mse:47.006168365478516, mae:1.1833330392837524
	iters: 2100, cost time: 498.0658116340637s
[]
mse:45.026344299316406, mae:1.1897733211517334
	iters: 2200, cost time: 521.9519126415253s
[]
mse:45.77151870727539, mae:1.3039711713790894
	iters: 2300, cost time: 548.6120052337646s
[]
mse:44.828304290771484, mae:1.352512240409851
	iters: 2400, cost time: 576.7616765499115s
[]
mse:42.98960494995117, mae:1.3203939199447632
	iters: 2500, cost time: 604.6324307918549s
[]
mse:41.280208587646484, mae:1.2823323011398315
	iters: 2600, cost time: 630.6183836460114s
[]
mse:39.73576736450195, mae:1.253739833831787
	iters: 2700, cost time: 655.8351576328278s
[]
mse:38.30723571777344, mae:1.2288352251052856
	iters: 2800, cost time: 681.3588166236877s
[]
mse:37.05354690551758, mae:1.206376552581787
	iters: 2900, cost time: 706.0919742584229s
[]
mse:35.78181076049805, mae:1.1751660108566284
	iters: 3000, cost time: 731.8259224891663s
[]
mse:34.60045623779297, mae:1.1495693922042847
	iters: 3100, cost time: 757.3641617298126s
[]
mse:33.50735855102539, mae:1.125723958015442
	iters: 3200, cost time: 782.2493886947632s
[]
mse:32.50114440917969, mae:1.1076987981796265
	iters: 3300, cost time: 809.0883147716522s
[]
mse:31.53468894958496, mae:1.0897750854492188
	iters: 3400, cost time: 835.532913684845s
[]
mse:30.966598510742188, mae:1.1027289628982544
	iters: 3500, cost time: 860.7486782073975s
[]
mse:30.087736129760742, mae:1.080337405204773
	iters: 3600, cost time: 885.7797813415527s
[]
mse:29.268997192382812, mae:1.0648480653762817
	iters: 3700, cost time: 914.4791040420532s
[]
mse:28.485504150390625, mae:1.0457251071929932
	iters: 3800, cost time: 939.698011636734s
[]
mse:27.749282836914062, mae:1.0305589437484741
	iters: 3900, cost time: 966.4179546833038s
[]
mse:27.852407455444336, mae:1.0856026411056519
	iters: 4000, cost time: 993.2293772697449s
[]
mse:27.739620208740234, mae:1.0951298475265503
	iters: 4100, cost time: 1020.0433351993561s
[]
mse:27.068235397338867, mae:1.0756745338439941
	iters: 4200, cost time: 1046.4376018047333s
[]
mse:27.41303825378418, mae:1.0966336727142334
	iters: 4300, cost time: 1074.4939827919006s
[]
mse:35.68582534790039, mae:1.3267282247543335
	iters: 4400, cost time: 1102.1382746696472s
[]
mse:35.17682647705078, mae:1.3251752853393555
	iters: 4500, cost time: 1131.5376241207123s
[]
mse:34.56492233276367, mae:1.3213615417480469
	iters: 4600, cost time: 1157.5996255874634s
[]
mse:34.80596923828125, mae:1.3421438932418823
	iters: 4700, cost time: 1187.7534136772156s
[]
mse:34.071693420410156, mae:1.3215638399124146
	iters: 4800, cost time: 1218.8059978485107s
[]
mse:33.36882400512695, mae:1.302916407585144
	iters: 4900, cost time: 1252.824077129364s
[]
mse:32.700836181640625, mae:1.2862411737442017
	iters: 5000, cost time: 1279.6411111354828s
[]
mse:32.061485290527344, mae:1.2699164152145386
	iters: 5100, cost time: 1311.5273823738098s
[]
mse:31.479928970336914, mae:1.2624672651290894
	iters: 5200, cost time: 1341.3190047740936s
[]
mse:30.882102966308594, mae:1.2459913492202759
	iters: 5300, cost time: 1372.1027884483337s
[]
mse:30.31321144104004, mae:1.231683373451233
	iters: 5400, cost time: 1401.158523797989s
[]
mse:29.760944366455078, mae:1.216555118560791
	iters: 5500, cost time: 1430.0150146484375s
[]
mse:29.25181007385254, mae:1.2056843042373657
	iters: 5600, cost time: 1457.8512852191925s
[]
mse:28.733287811279297, mae:1.189707636833191
	iters: 5700, cost time: 1485.8703107833862s
[]
mse:28.23269271850586, mae:1.1740965843200684
	iters: 5800, cost time: 1514.8921210765839s
[]
mse:27.750322341918945, mae:1.1595780849456787
	iters: 5900, cost time: 1542.5842425823212s
[]
mse:27.306747436523438, mae:1.1493592262268066
	iters: 6000, cost time: 1572.9051477909088s
[]
mse:26.894378662109375, mae:1.1420772075653076
	iters: 6100, cost time: 1602.9373030662537s
[]
mse:26.46226692199707, mae:1.1299010515213013
	iters: 6200, cost time: 1634.5395641326904s
[]
mse:26.042442321777344, mae:1.1176165342330933
	iters: 6300, cost time: 1662.3696858882904s
[]
mse:25.663864135742188, mae:1.1091030836105347
	iters: 6400, cost time: 1689.730117559433s
[]
mse:25.271991729736328, mae:1.0988667011260986
	iters: 6500, cost time: 1718.4377200603485s
[]
mse:24.93963623046875, mae:1.0949636697769165
	iters: 6600, cost time: 1746.7734196186066s
[]
mse:47.94146728515625, mae:1.3439873456954956
	iters: 6700, cost time: 1775.7298836708069s
[]
mse:49.28451919555664, mae:1.3828909397125244
	iters: 6800, cost time: 1804.857272386551s
[]
mse:48.56299591064453, mae:1.3669670820236206
	iters: 6900, cost time: 1835.4057877063751s
[]
mse:47.862613677978516, mae:1.3522276878356934
	iters: 7000, cost time: 1866.70734167099s
[]
mse:47.182762145996094, mae:1.3375240564346313
	iters: 7100, cost time: 1895.6135721206665s
[]
mse:46.5209846496582, mae:1.322749137878418
	iters: 7200, cost time: 1929.5720946788788s
[]
mse:45.88018035888672, mae:1.3100478649139404
	iters: 7300, cost time: 1960.7245917320251s
[]
mse:45.26472091674805, mae:1.2999333143234253
	iters: 7400, cost time: 1992.1067583560944s
[]
mse:44.661033630371094, mae:1.2876344919204712
	iters: 7500, cost time: 2022.0957233905792s
[]
mse:44.071128845214844, mae:1.2760039567947388
	iters: 7600, cost time: 2052.047840833664s
[]
mse:43.49488830566406, mae:1.2641040086746216
	iters: 7700, cost time: 2081.6931416988373s
[]
mse:42.946441650390625, mae:1.2534373998641968
	iters: 7800, cost time: 2110.8470511436462s
[]
mse:42.456817626953125, mae:1.245782494544983
	iters: 7900, cost time: 2138.0890667438507s
[]
mse:41.93360900878906, mae:1.2372677326202393
	iters: 8000, cost time: 2168.6621367931366s
[]
mse:41.41617965698242, mae:1.2264015674591064
	iters: 8100, cost time: 2198.7483406066895s
[]
mse:40.915130615234375, mae:1.2166805267333984
	iters: 8200, cost time: 2229.6327056884766s
[]
mse:40.546356201171875, mae:1.2205629348754883
	iters: 8300, cost time: 2260.7476053237915s
[]
mse:40.12196350097656, mae:1.213080883026123
	iters: 8400, cost time: 2292.491188764572s
[]
mse:39.648868560791016, mae:1.2031112909317017
	iters: 8500, cost time: 2325.672728061676s
[]
mse:39.193153381347656, mae:1.1953074932098389
	iters: 8600, cost time: 2358.426948070526s
[]
mse:38.76620864868164, mae:1.1891429424285889
	iters: 8700, cost time: 2389.3450706005096s
[]
mse:38.32334518432617, mae:1.179446816444397
	iters: 8800, cost time: 2418.7515976428986s
[]
mse:37.89539337158203, mae:1.1709994077682495
	iters: 8900, cost time: 2452.0471353530884s
[]
mse:37.82283401489258, mae:1.1836392879486084
	iters: 9000, cost time: 2487.054295063019s
[]
mse:37.81584548950195, mae:1.1924680471420288
	iters: 9100, cost time: 2518.1823902130127s
[]
mse:37.63515090942383, mae:1.1981008052825928
	iters: 9200, cost time: 2552.4945590496063s
[]
mse:40.879032135009766, mae:1.2314728498458862
	iters: 9300, cost time: 2579.5137600898743s
[]
mse:40.4674072265625, mae:1.2265146970748901
	iters: 9400, cost time: 2613.2872989177704s
[]
mse:40.043724060058594, mae:1.2188434600830078
	iters: 9500, cost time: 2644.726933479309s
[]
mse:39.679290771484375, mae:1.2155681848526
	iters: 9600, cost time: 2676.9496281147003s
[]
mse:39.270286560058594, mae:1.2067350149154663
	iters: 9700, cost time: 2707.9765343666077s
[]
mse:38.88799285888672, mae:1.2015104293823242
	iters: 9800, cost time: 2740.463399410248s
[]
mse:38.49760055541992, mae:1.1943038702011108
	iters: 9900, cost time: 2773.545707464218s
[]
mse:39.706241607666016, mae:1.2154157161712646
	iters: 10000, cost time: 2804.300572872162s
[]
mse:74.27711486816406, mae:1.379380226135254
	iters: 10100, cost time: 2836.78879904747s
[]
mse:80.85272216796875, mae:1.4560986757278442
	iters: 10200, cost time: 2868.473119497299s
[]
mse:80.1004638671875, mae:1.448283314704895
	iters: 10300, cost time: 2902.1405205726624s
[]
mse:79.32470703125, mae:1.437157154083252
	iters: 10400, cost time: 2928.2251138687134s
[]
mse:91.8492660522461, mae:1.6307278871536255
[91.68962508165842, 78.12510728387484, 75.79749501946984, 75.41221643372921, 75.99730853233937, 78.77827342588658, 84.06418220317833, 88.40182474284379, 94.93823208714987, 98.301240304448, 93.25883015551356, 84.26136451837898, 82.35831673356186, 85.81339870565219, 87.37919842883203, 83.08194885334954, 86.13018356398757, 92.13404294195036, 99.57522602658844, 102.16569761229468, 97.35333481149569, 88.57625612957, 83.9921490790304, 84.76674107694721, 83.86965075895948, 83.05314463706252, 84.62902082493902, 95.8482562774141, 104.42892339770816, 103.80307746830006, 99.81135457115474, 92.65081671915335, 88.61028040450245, 83.9920189292007, 84.82605723117561, 87.34393580543005, 92.54526431940043, 102.36473892571126, 105.05968122715922, 100.87556521676193, 96.62193783564443, 93.84757816961854, 91.76987676099863, 92.83325431347913, 94.4155028389026, 95.90582689139208, 99.71060574212572, 102.85529178538249, 101.66039308528569, 95.96881076932081, 88.74126937885734, 83.22384458229351, 81.13148892477895, 82.06696966418669, 82.7211456245142, 89.64961759151326, 99.95497154888993, 101.09975792544836, 95.85672123425068, 89.80147368709446, 83.78695382647004, 82.30755886180144, 82.57010689467978, 84.26827969728438, 90.23029581442998, 99.28674018424657, 103.83095794705143, 97.43539301727766, 90.15643936706056, 81.59491219713976, 80.46284725478266, 82.47314790927156, 87.5002118799883, 93.50760613939056, 97.61686905729165, 100.31107843868229, 99.78972606334598, 93.67982502122737, 89.28811873714596, 89.69518668587455, 92.33557751925174, 94.03405143171106, 100.36205933601164, 106.29408761799051, 107.44121706491188, 104.78824090199342, 95.39554587028069, 86.81368354237979, 90.0739590059149, 96.51126500342914, 99.07744722081107, 96.43322106763526, 96.43771409747266, 89.24165581847134, 88.64026932738187, 82.75645240595884]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:91.482666015625, mae:1.6281787157058716
Test - cost time: 2951.4631044864655s
