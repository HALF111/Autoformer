Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=2)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 30.676303386688232s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 27.811442852020264s
[]
mse:0.32610219717025757, mae:0.4056139886379242
	iters: 200, cost time: 54.945735931396484s
[]
mse:0.2968968152999878, mae:0.3889130651950836
	iters: 300, cost time: 81.24805164337158s
[]
mse:0.26326221227645874, mae:0.3692195415496826
	iters: 400, cost time: 107.03559064865112s
[]
mse:0.2493615597486496, mae:0.36333683133125305
	iters: 500, cost time: 133.19389510154724s
[]
mse:0.2298087477684021, mae:0.3500121235847473
	iters: 600, cost time: 156.72921872138977s
[]
mse:0.22097331285476685, mae:0.34068799018859863
	iters: 700, cost time: 179.93087720870972s
[]
mse:0.21746224164962769, mae:0.3342723250389099
	iters: 800, cost time: 203.6303527355194s
[]
mse:0.20653747022151947, mae:0.3237677812576294
	iters: 900, cost time: 227.34236693382263s
[]
mse:0.2098408043384552, mae:0.3178127706050873
	iters: 1000, cost time: 251.0110743045807s
[]
mse:0.2235017716884613, mae:0.3210448920726776
	iters: 1100, cost time: 276.9485993385315s
[]
mse:0.22539974749088287, mae:0.32172691822052
	iters: 1200, cost time: 300.60485577583313s
[]
mse:0.21933601796627045, mae:0.3176649808883667
	iters: 1300, cost time: 324.66769433021545s
[]
mse:0.21788664162158966, mae:0.31524255871772766
	iters: 1400, cost time: 350.07412791252136s
[]
mse:0.22828076779842377, mae:0.31615376472473145
	iters: 1500, cost time: 376.7880976200104s
[]
mse:0.2740893065929413, mae:0.33031126856803894
	iters: 1600, cost time: 403.82491183280945s
[]
mse:0.28450775146484375, mae:0.3352433145046234
	iters: 1700, cost time: 431.5451259613037s
[]
mse:0.2770839035511017, mae:0.3321082592010498
	iters: 1800, cost time: 459.51888728141785s
[]
mse:0.2768112123012543, mae:0.3313959538936615
	iters: 1900, cost time: 484.11684679985046s
[]
mse:0.2817443013191223, mae:0.33812639117240906
	iters: 2000, cost time: 507.6690468788147s
[]
mse:0.27862095832824707, mae:0.3378381133079529
	iters: 2100, cost time: 531.2605118751526s
[]
mse:0.28598150610923767, mae:0.34500646591186523
	iters: 2200, cost time: 555.1453945636749s
[]
mse:0.27951666712760925, mae:0.3419756591320038
	iters: 2300, cost time: 580.1069524288177s
[]
mse:0.2802572548389435, mae:0.3450084626674652
	iters: 2400, cost time: 605.7321922779083s
[]
mse:0.2821931838989258, mae:0.34838739037513733
	iters: 2500, cost time: 629.4721558094025s
[]
mse:0.27870550751686096, mae:0.3474554121494293
	iters: 2600, cost time: 653.6192245483398s
[]
mse:0.2757496237754822, mae:0.34682026505470276
	iters: 2700, cost time: 678.3154633045197s
[]
mse:0.27621281147003174, mae:0.34893983602523804
	iters: 2800, cost time: 702.371652841568s
[]
mse:0.27287694811820984, mae:0.3480313718318939
	iters: 2900, cost time: 730.6232204437256s
[]
mse:0.2688866853713989, mae:0.34607255458831787
	iters: 3000, cost time: 757.762128829956s
[]
mse:0.2689880430698395, mae:0.34720849990844727
	iters: 3100, cost time: 785.8564221858978s
[]
mse:0.2665731906890869, mae:0.34563371539115906
	iters: 3200, cost time: 813.1638958454132s
[]
mse:0.26582878828048706, mae:0.3451915681362152
	iters: 3300, cost time: 841.3668699264526s
[]
mse:0.2678351104259491, mae:0.3473774492740631
	iters: 3400, cost time: 868.2429916858673s
[]
mse:0.2658296823501587, mae:0.34615257382392883
	iters: 3500, cost time: 894.6427998542786s
[]
mse:0.2624821960926056, mae:0.344403475522995
	iters: 3600, cost time: 920.001739025116s
[]
mse:0.26227492094039917, mae:0.3456040918827057
	iters: 3700, cost time: 943.8739395141602s
[]
mse:0.25949129462242126, mae:0.3442155718803406
	iters: 3800, cost time: 968.7622673511505s
[]
mse:0.2573084235191345, mae:0.34337133169174194
	iters: 3900, cost time: 993.5669980049133s
[]
mse:0.25709062814712524, mae:0.34244516491889954
	iters: 4000, cost time: 1018.1161539554596s
[]
mse:0.25552722811698914, mae:0.34101831912994385
	iters: 4100, cost time: 1045.5833303928375s
[]
mse:0.2528465986251831, mae:0.33912694454193115
	iters: 4200, cost time: 1070.488116979599s
[]
mse:0.24989798665046692, mae:0.33714789152145386
	iters: 4300, cost time: 1096.7259495258331s
[]
mse:0.24831576645374298, mae:0.33661893010139465
	iters: 4400, cost time: 1124.6290924549103s
[]
mse:0.2475339025259018, mae:0.33578726649284363
	iters: 4500, cost time: 1154.2639963626862s
[]
mse:0.24740837514400482, mae:0.33541035652160645
	iters: 4600, cost time: 1183.1516544818878s
[]
mse:0.24760515987873077, mae:0.33584868907928467
	iters: 4700, cost time: 1212.5137708187103s
[]
mse:0.24755392968654633, mae:0.336054265499115
	iters: 4800, cost time: 1238.53271317482s
[]
mse:0.24824461340904236, mae:0.3373481035232544
	iters: 4900, cost time: 1263.461097240448s
[]
mse:0.24883660674095154, mae:0.3374401926994324
	iters: 5000, cost time: 1288.6429615020752s
[]
mse:0.24877643585205078, mae:0.3369583189487457
	iters: 5100, cost time: 1312.953584432602s
[]
mse:0.24934494495391846, mae:0.3381235599517822
	iters: 5200, cost time: 1338.5525681972504s
[]
mse:0.2479575127363205, mae:0.33770495653152466
	iters: 5300, cost time: 1365.0266687870026s
[]
mse:0.24585016071796417, mae:0.33632129430770874
	iters: 5400, cost time: 1389.0930876731873s
[]
mse:0.2450307011604309, mae:0.3358577489852905
	iters: 5500, cost time: 1414.0788326263428s
[]
mse:0.24318386614322662, mae:0.3344007730484009
	iters: 5600, cost time: 1438.7332291603088s
[]
mse:0.2421044558286667, mae:0.33355218172073364
	iters: 5700, cost time: 1463.2845087051392s
[]
mse:0.24080687761306763, mae:0.33256179094314575
	iters: 5800, cost time: 1492.2377758026123s
[]
mse:0.24066683650016785, mae:0.33228054642677307
	iters: 5900, cost time: 1519.7695682048798s
[]
mse:0.24008452892303467, mae:0.3316912353038788
	iters: 6000, cost time: 1548.9174137115479s
[]
mse:0.23991148173809052, mae:0.3312618136405945
	iters: 6100, cost time: 1577.3435246944427s
[]
mse:0.243186816573143, mae:0.3315185606479645
	iters: 6200, cost time: 1605.095609664917s
[]
mse:0.24262790381908417, mae:0.33108803629875183
	iters: 6300, cost time: 1630.8405497074127s
[]
mse:0.24392405152320862, mae:0.3318830728530884
	iters: 6400, cost time: 1658.639356136322s
[]
mse:0.24509496986865997, mae:0.33265990018844604
	iters: 6500, cost time: 1683.5117089748383s
[]
mse:0.2439616471529007, mae:0.3317994773387909
	iters: 6600, cost time: 1707.7758285999298s
[]
mse:0.24268049001693726, mae:0.33091408014297485
	iters: 6700, cost time: 1732.8680217266083s
[]
mse:0.2412060797214508, mae:0.32968100905418396
	iters: 6800, cost time: 1757.26384973526s
[]
mse:0.24087795615196228, mae:0.3292618989944458
	iters: 6900, cost time: 1783.402480840683s
[]
mse:0.24021267890930176, mae:0.3291095495223999
	iters: 7000, cost time: 1810.6845664978027s
[]
mse:0.2399129420518875, mae:0.32868027687072754
	iters: 7100, cost time: 1835.8420491218567s
[]
mse:0.23919565975666046, mae:0.32810908555984497
	iters: 7200, cost time: 1861.5837440490723s
[]
mse:0.23998279869556427, mae:0.3286767303943634
	iters: 7300, cost time: 1889.4594690799713s
[]
mse:0.24508869647979736, mae:0.33062544465065
	iters: 7400, cost time: 1916.6949875354767s
[]
mse:0.24871039390563965, mae:0.3309724032878876
	iters: 7500, cost time: 1945.4572923183441s
[]
mse:0.2498796284198761, mae:0.33168259263038635
	iters: 7600, cost time: 1974.37797164917s
[]
mse:0.25004202127456665, mae:0.33212482929229736
	iters: 7700, cost time: 2002.402817249298s
[]
mse:0.2501910626888275, mae:0.3312638998031616
	iters: 7800, cost time: 2029.6915390491486s
[]
mse:0.24940559267997742, mae:0.3308883607387543
	iters: 7900, cost time: 2055.0889439582825s
[]
mse:0.24953317642211914, mae:0.33133116364479065
	iters: 8000, cost time: 2080.4464411735535s
[]
mse:0.2481609433889389, mae:0.33015236258506775
	iters: 8100, cost time: 2105.638345718384s
[]
mse:0.24701960384845734, mae:0.3293657898902893
	iters: 8200, cost time: 2133.767793416977s
[]
mse:0.24785760045051575, mae:0.3292302191257477
	iters: 8300, cost time: 2158.3307836055756s
[]
mse:0.2468547821044922, mae:0.3290063738822937
	iters: 8400, cost time: 2183.013456106186s
[]
mse:0.24588608741760254, mae:0.32845717668533325
	iters: 8500, cost time: 2207.5953452587128s
[]
mse:0.24471750855445862, mae:0.32793644070625305
	iters: 8600, cost time: 2233.0687069892883s
[]
mse:0.24386267364025116, mae:0.32766270637512207
	iters: 8700, cost time: 2260.3143725395203s
[]
mse:0.2428181767463684, mae:0.32713621854782104
	iters: 8800, cost time: 2285.7866723537445s
[]
mse:0.24167278409004211, mae:0.32646310329437256
	iters: 8900, cost time: 2311.039535045624s
[]
mse:0.24180462956428528, mae:0.32621046900749207
	iters: 9000, cost time: 2338.9286065101624s
[]
mse:0.2416100949048996, mae:0.325821191072464
	iters: 9100, cost time: 2366.2489178180695s
[]
mse:0.24465787410736084, mae:0.32742834091186523
	iters: 9200, cost time: 2395.1571736335754s
[]
mse:0.24723419547080994, mae:0.3292604684829712
	iters: 9300, cost time: 2424.9666624069214s
[]
mse:0.2506355345249176, mae:0.32954123616218567
	iters: 9400, cost time: 2453.8446049690247s
[]
mse:0.25356632471084595, mae:0.33091288805007935
	iters: 9500, cost time: 2479.617823600769s
[]
mse:0.25523826479911804, mae:0.3319859206676483
	iters: 9600, cost time: 2504.4023411273956s
[]
mse:0.25615695118904114, mae:0.3320998251438141
	iters: 9700, cost time: 2529.078119277954s
[]
mse:0.25520604848861694, mae:0.3315645158290863
	iters: 9800, cost time: 2553.630455970764s
[]
mse:0.25663700699806213, mae:0.33199864625930786
	iters: 9900, cost time: 2579.9916455745697s
[]
mse:0.2582913041114807, mae:0.33252841234207153
	iters: 10000, cost time: 2611.306983232498s
[]
mse:0.2597399652004242, mae:0.3333090841770172
	iters: 10100, cost time: 2636.631669998169s
[]
mse:0.2617962956428528, mae:0.3336164653301239
	iters: 10200, cost time: 2661.446385860443s
[]
mse:0.26146790385246277, mae:0.3333498239517212
	iters: 10300, cost time: 2686.2230496406555s
[]
mse:0.2600198984146118, mae:0.33244433999061584
	iters: 10400, cost time: 2714.584154844284s
[]
mse:0.25886574387550354, mae:0.3317045569419861
[0.18476579275030547, 0.19299169978264566, 0.19363985133625045, 0.19595352057992665, 0.19952296454934543, 0.20347610156930881, 0.20821485363319908, 0.21352774049666376, 0.21907450761096728, 0.22532525853526236, 0.2314175569827942, 0.23593964662238967, 0.23831624307961116, 0.23796798440068462, 0.23702244048937976, 0.2363161497526634, 0.236566485341211, 0.2377404622186606, 0.23940153413185403, 0.2418412460812857, 0.24404604553253212, 0.24608231377776296, 0.2480936247888597, 0.25019452571364176, 0.2521358105420534, 0.25399391576330305, 0.25589972739801675, 0.2577881239386178, 0.2591543082717295, 0.2601034280346715, 0.26059231622792334, 0.26079634731563756, 0.26061813006761986, 0.2602285891545263, 0.2600544263183488, 0.25995054476194784, 0.2597305953815385, 0.2594361146481719, 0.2594083199031938, 0.2594231561811485, 0.25971622967589447, 0.26023177355783805, 0.26079394181353677, 0.261324741005147, 0.2621112759569278, 0.2626142631721305, 0.26311978953194953, 0.26369366381387466, 0.2642885207794949, 0.26498247738924036, 0.265377161332664, 0.265710196394, 0.2659614587834726, 0.2661457353467546, 0.2665551429340129, 0.266968136145464, 0.26744939848163196, 0.26796280536460876, 0.2683376250290984, 0.26872497664376443, 0.2692912686387008, 0.2697330707219033, 0.2702071157927732, 0.270509045622497, 0.2707221792611425, 0.27065425647749225, 0.2705638715677207, 0.27005186540678167, 0.26933826866093485, 0.2686191190805319, 0.26846217636692427, 0.2688160516811754, 0.26904992363379987, 0.2690867894972603, 0.26926840577109235, 0.2696307231347964, 0.27007432330980446, 0.2704638512829627, 0.27106761076312463, 0.27173670046632503, 0.27230002754947513, 0.27276418632989996, 0.27300346034176093, 0.2731798891402472, 0.27380045768863703, 0.27472254303450744, 0.2758582159633381, 0.27757128281469773, 0.28006675602339937, 0.2834998390177919, 0.2875447441183608, 0.29225119033659663, 0.2968818932899735, 0.3033276567495885, 0.3119896897333287, 0.3138049219050832]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.25821584463119507, mae:0.33125045895576477
Test - cost time: 2729.228979587555s
