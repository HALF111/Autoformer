Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=10)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 39.09519553184509s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 23.699291706085205s
[]
mse:0.3260206878185272, mae:0.40553703904151917
	iters: 200, cost time: 45.996716260910034s
[]
mse:0.29678109288215637, mae:0.38875359296798706
	iters: 300, cost time: 69.57176113128662s
[]
mse:0.26312029361724854, mae:0.3690398931503296
	iters: 400, cost time: 94.86129713058472s
[]
mse:0.24921353161334991, mae:0.36316540837287903
	iters: 500, cost time: 117.5000069141388s
[]
mse:0.22967275977134705, mae:0.3498254716396332
	iters: 600, cost time: 141.23291563987732s
[]
mse:0.22083142399787903, mae:0.3404993414878845
	iters: 700, cost time: 164.46412587165833s
[]
mse:0.21732097864151, mae:0.3340888023376465
	iters: 800, cost time: 188.2561526298523s
[]
mse:0.20640936493873596, mae:0.323592871427536
	iters: 900, cost time: 213.12110781669617s
[]
mse:0.2097182422876358, mae:0.31763267517089844
	iters: 1000, cost time: 240.89228415489197s
[]
mse:0.22339476644992828, mae:0.32088106870651245
	iters: 1100, cost time: 267.90387415885925s
[]
mse:0.22531449794769287, mae:0.3215797543525696
	iters: 1200, cost time: 294.04633474349976s
[]
mse:0.21924693882465363, mae:0.3175168037414551
	iters: 1300, cost time: 321.5656177997589s
[]
mse:0.21779730916023254, mae:0.31509074568748474
	iters: 1400, cost time: 349.62530040740967s
[]
mse:0.22819098830223083, mae:0.31601420044898987
	iters: 1500, cost time: 375.2068901062012s
[]
mse:0.2739982008934021, mae:0.33017754554748535
	iters: 1600, cost time: 400.9890925884247s
[]
mse:0.2844775319099426, mae:0.33511948585510254
	iters: 1700, cost time: 425.18429493904114s
[]
mse:0.2770478129386902, mae:0.3319731056690216
	iters: 1800, cost time: 448.8937964439392s
[]
mse:0.2767634093761444, mae:0.33125048875808716
	iters: 1900, cost time: 472.1911361217499s
[]
mse:0.28168827295303345, mae:0.337979257106781
	iters: 2000, cost time: 496.3671054840088s
[]
mse:0.2785608172416687, mae:0.33768323063850403
	iters: 2100, cost time: 522.8916006088257s
[]
mse:0.2859281003475189, mae:0.34484782814979553
	iters: 2200, cost time: 548.348573923111s
[]
mse:0.2794555723667145, mae:0.3418034017086029
	iters: 2300, cost time: 571.9590530395508s
[]
mse:0.2801934480667114, mae:0.3448350429534912
	iters: 2400, cost time: 594.7911007404327s
[]
mse:0.28212329745292664, mae:0.34821340441703796
	iters: 2500, cost time: 618.9327018260956s
[]
mse:0.2786392867565155, mae:0.3472881317138672
	iters: 2600, cost time: 645.0872502326965s
[]
mse:0.2756821811199188, mae:0.3466550409793854
	iters: 2700, cost time: 670.9884641170502s
[]
mse:0.2761442959308624, mae:0.34877678751945496
	iters: 2800, cost time: 697.2615616321564s
[]
mse:0.27280619740486145, mae:0.3478687107563019
	iters: 2900, cost time: 722.5456659793854s
[]
mse:0.26881536841392517, mae:0.3459092080593109
	iters: 3000, cost time: 748.9850685596466s
[]
mse:0.26891785860061646, mae:0.3470456004142761
	iters: 3100, cost time: 772.822815656662s
[]
mse:0.26650306582450867, mae:0.34547004103660583
	iters: 3200, cost time: 796.2622101306915s
[]
mse:0.26575636863708496, mae:0.3450270891189575
	iters: 3300, cost time: 821.4585511684418s
[]
mse:0.2677629888057709, mae:0.3472137153148651
	iters: 3400, cost time: 846.3880851268768s
[]
mse:0.2657579183578491, mae:0.3459898829460144
	iters: 3500, cost time: 871.9784507751465s
[]
mse:0.2624107003211975, mae:0.3442398011684418
	iters: 3600, cost time: 894.7984428405762s
[]
mse:0.2622036933898926, mae:0.3454413414001465
	iters: 3700, cost time: 919.6183688640594s
[]
mse:0.2594181001186371, mae:0.34404751658439636
	iters: 3800, cost time: 945.4217700958252s
[]
mse:0.25723522901535034, mae:0.3432050943374634
	iters: 3900, cost time: 968.6024000644684s
[]
mse:0.2570183575153351, mae:0.3422810733318329
	iters: 4000, cost time: 993.7008361816406s
[]
mse:0.2554543614387512, mae:0.34085333347320557
	iters: 4100, cost time: 1019.0068683624268s
[]
mse:0.2527741491794586, mae:0.3389616906642914
	iters: 4200, cost time: 1041.9874064922333s
[]
mse:0.24982647597789764, mae:0.3369794189929962
	iters: 4300, cost time: 1067.9099848270416s
[]
mse:0.2482437938451767, mae:0.336445689201355
	iters: 4400, cost time: 1093.3328371047974s
[]
mse:0.2474614381790161, mae:0.3356111943721771
	iters: 4500, cost time: 1118.9123520851135s
[]
mse:0.24733982980251312, mae:0.3352336287498474
	iters: 4600, cost time: 1148.6014320850372s
[]
mse:0.24753069877624512, mae:0.3356702923774719
	iters: 4700, cost time: 1176.0858068466187s
[]
mse:0.2474799007177353, mae:0.33587613701820374
	iters: 4800, cost time: 1203.849161863327s
[]
mse:0.24817025661468506, mae:0.3371698558330536
	iters: 4900, cost time: 1233.9515972137451s
[]
mse:0.24876204133033752, mae:0.3372592628002167
	iters: 5000, cost time: 1262.2250909805298s
[]
mse:0.24870412051677704, mae:0.3367788791656494
	iters: 5100, cost time: 1290.8213865756989s
[]
mse:0.24927392601966858, mae:0.3379460573196411
	iters: 5200, cost time: 1318.8452394008636s
[]
mse:0.2478853315114975, mae:0.33752739429473877
	iters: 5300, cost time: 1345.004757642746s
[]
mse:0.24577561020851135, mae:0.3361399471759796
	iters: 5400, cost time: 1370.0865695476532s
[]
mse:0.24495533108711243, mae:0.3356764018535614
	iters: 5500, cost time: 1395.905382156372s
[]
mse:0.2431071251630783, mae:0.3342181444168091
	iters: 5600, cost time: 1423.2845916748047s
[]
mse:0.24202537536621094, mae:0.3333669602870941
	iters: 5700, cost time: 1449.0900967121124s
[]
mse:0.24072644114494324, mae:0.3323759436607361
	iters: 5800, cost time: 1475.7259449958801s
[]
mse:0.24058662354946136, mae:0.33209410309791565
	iters: 5900, cost time: 1503.473558664322s
[]
mse:0.24000775814056396, mae:0.331505686044693
	iters: 6000, cost time: 1527.985019683838s
[]
mse:0.239833801984787, mae:0.3310759663581848
	iters: 6100, cost time: 1551.57080411911s
[]
mse:0.24310818314552307, mae:0.3313330113887787
	iters: 6200, cost time: 1578.246676683426s
[]
mse:0.24255084991455078, mae:0.33090323209762573
	iters: 6300, cost time: 1603.262707710266s
[]
mse:0.24384808540344238, mae:0.3316991925239563
	iters: 6400, cost time: 1630.6468284130096s
[]
mse:0.24501852691173553, mae:0.332475870847702
	iters: 6500, cost time: 1656.2048304080963s
[]
mse:0.2438817024230957, mae:0.33161461353302
	iters: 6600, cost time: 1686.1262741088867s
[]
mse:0.24259968101978302, mae:0.3307283818721771
	iters: 6700, cost time: 1717.0000314712524s
[]
mse:0.24112559854984283, mae:0.32949456572532654
	iters: 6800, cost time: 1741.3358464241028s
[]
mse:0.24079616367816925, mae:0.3290743827819824
	iters: 6900, cost time: 1767.3460910320282s
[]
mse:0.24012911319732666, mae:0.32892268896102905
	iters: 7000, cost time: 1793.3993790149689s
[]
mse:0.23982936143875122, mae:0.32849276065826416
	iters: 7100, cost time: 1818.8651106357574s
[]
mse:0.2391115427017212, mae:0.32791996002197266
	iters: 7200, cost time: 1844.3632745742798s
[]
mse:0.23989859223365784, mae:0.32848742604255676
	iters: 7300, cost time: 1871.0434529781342s
[]
mse:0.24500533938407898, mae:0.3304365277290344
	iters: 7400, cost time: 1897.026052236557s
[]
mse:0.24862179160118103, mae:0.3307819962501526
	iters: 7500, cost time: 1922.310882806778s
[]
mse:0.24979311227798462, mae:0.33149152994155884
	iters: 7600, cost time: 1946.7445607185364s
[]
mse:0.2499561905860901, mae:0.3319348394870758
	iters: 7700, cost time: 1971.0188822746277s
[]
mse:0.25010523200035095, mae:0.3310732841491699
	iters: 7800, cost time: 1996.2196638584137s
[]
mse:0.24932053685188293, mae:0.3306986391544342
	iters: 7900, cost time: 2021.2018988132477s
[]
mse:0.249447301030159, mae:0.3311402201652527
	iters: 8000, cost time: 2045.638355731964s
[]
mse:0.2480747252702713, mae:0.32996025681495667
	iters: 8100, cost time: 2069.395486831665s
[]
mse:0.24693284928798676, mae:0.32917287945747375
	iters: 8200, cost time: 2094.4462580680847s
[]
mse:0.24777038395404816, mae:0.3290378749370575
	iters: 8300, cost time: 2118.610848903656s
[]
mse:0.24676820635795593, mae:0.3288141191005707
	iters: 8400, cost time: 2142.8320899009705s
[]
mse:0.2458001673221588, mae:0.32826653122901917
	iters: 8500, cost time: 2166.8786613941193s
[]
mse:0.24463120102882385, mae:0.3277442455291748
	iters: 8600, cost time: 2191.2123165130615s
[]
mse:0.24377644062042236, mae:0.32747042179107666
	iters: 8700, cost time: 2216.7947812080383s
[]
mse:0.24273210763931274, mae:0.3269442319869995
	iters: 8800, cost time: 2240.657560110092s
[]
mse:0.2415865957736969, mae:0.3262707591056824
	iters: 8900, cost time: 2265.5474128723145s
[]
mse:0.24171878397464752, mae:0.32601815462112427
	iters: 9000, cost time: 2289.7574813365936s
[]
mse:0.2415248602628708, mae:0.3256293833255768
	iters: 9100, cost time: 2314.6500804424286s
[]
mse:0.24457597732543945, mae:0.32723769545555115
	iters: 9200, cost time: 2339.9301800727844s
[]
mse:0.2471507042646408, mae:0.32906877994537354
	iters: 9300, cost time: 2366.6669924259186s
[]
mse:0.25055307149887085, mae:0.329350084066391
	iters: 9400, cost time: 2392.5398416519165s
[]
mse:0.25348347425460815, mae:0.33072134852409363
	iters: 9500, cost time: 2418.8264923095703s
[]
mse:0.2551545798778534, mae:0.33179429173469543
	iters: 9600, cost time: 2444.825813293457s
[]
mse:0.25607478618621826, mae:0.3319074511528015
	iters: 9700, cost time: 2470.8515853881836s
[]
mse:0.25512346625328064, mae:0.33137157559394836
	iters: 9800, cost time: 2496.936687231064s
[]
mse:0.2565535306930542, mae:0.3318053185939789
	iters: 9900, cost time: 2520.8002099990845s
[]
mse:0.2582070827484131, mae:0.332334041595459
	iters: 10000, cost time: 2546.196980237961s
[]
mse:0.25965404510498047, mae:0.33311349153518677
	iters: 10100, cost time: 2571.5772020816803s
[]
mse:0.2617098391056061, mae:0.3334202766418457
	iters: 10200, cost time: 2597.3808715343475s
[]
mse:0.26138243079185486, mae:0.33315446972846985
	iters: 10300, cost time: 2621.853806257248s
[]
mse:0.25993454456329346, mae:0.3322492241859436
	iters: 10400, cost time: 2645.8968091011047s
[]
mse:0.25878044962882996, mae:0.3315092623233795
[0.18461149587339287, 0.19285056410364132, 0.19350536406324298, 0.19581826711330336, 0.19939635107108244, 0.20335434707311814, 0.20809146396169095, 0.2134187289731497, 0.2189679391103772, 0.22522616156240285, 0.2313222317304177, 0.23585068645990695, 0.23822010533487525, 0.23786190270509733, 0.2369142265046302, 0.23621559403415832, 0.23645795677060547, 0.23763202541471753, 0.23930574856027576, 0.24175159267505844, 0.24396621401183455, 0.2460130350188966, 0.2480248654317767, 0.2501225578060519, 0.2520603865675046, 0.2539240431770139, 0.2558294794943479, 0.25772472279597886, 0.2590874207256186, 0.26002594925937955, 0.2604968952027437, 0.26068624194341555, 0.2605029992914924, 0.2601248562429243, 0.2599601389737964, 0.25985979177573165, 0.2596384802131765, 0.25934368268884, 0.25932568818755586, 0.25933551580351943, 0.2596473492929346, 0.26015745329729284, 0.2607084504494173, 0.2612322335261124, 0.26201311876456607, 0.26251922893242136, 0.2630292597302239, 0.26360171450945746, 0.2641959373619566, 0.26489028832773537, 0.2652845770480969, 0.2656151806350782, 0.2658764710958387, 0.26608111412561886, 0.26650870076017913, 0.2669306975136711, 0.26740121722781557, 0.267904400066148, 0.2682728890563411, 0.26865962515533404, 0.26921321962937234, 0.26964799910626824, 0.2701220758414814, 0.2704130250331518, 0.2706244476734775, 0.2705660623358973, 0.2704793424543517, 0.26997995268250663, 0.2692771340022666, 0.2685714634331546, 0.2684197412217546, 0.26876586809118036, 0.2689901759337216, 0.26900193722922555, 0.2691636103019368, 0.2695167321042179, 0.269962746107363, 0.2703535984647387, 0.2709681165382503, 0.27165677807595595, 0.272240798887399, 0.2727364933404291, 0.2730001182866892, 0.2731861849749737, 0.27381343250343027, 0.27472246969717956, 0.2758499907476101, 0.27755275988032485, 0.2800439367249051, 0.28347810694963177, 0.28750735497819446, 0.29216608533660526, 0.29671946760509216, 0.30308503717200475, 0.3117739119726062, 0.31360645551861904]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.25813058018684387, mae:0.3310547173023224
Test - cost time: 2657.432371854782s
