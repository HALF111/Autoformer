Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=20)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 22.59079098701477s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 23.42861008644104s
[]
mse:0.32596221566200256, mae:0.4054831564426422
	iters: 200, cost time: 45.303266286849976s
[]
mse:0.29668426513671875, mae:0.3886072039604187
	iters: 300, cost time: 68.43690347671509s
[]
mse:0.2629973888397217, mae:0.3688744604587555
	iters: 400, cost time: 91.18994235992432s
[]
mse:0.24908097088336945, mae:0.3630075752735138
	iters: 500, cost time: 114.5289957523346s
[]
mse:0.22956183552742004, mae:0.3496629297733307
	iters: 600, cost time: 138.32308840751648s
[]
mse:0.22071456909179688, mae:0.3403339087963104
	iters: 700, cost time: 161.45462918281555s
[]
mse:0.2172134965658188, mae:0.33394381403923035
	iters: 800, cost time: 184.41389656066895s
[]
mse:0.20631568133831024, mae:0.32345736026763916
	iters: 900, cost time: 207.62225222587585s
[]
mse:0.20962770283222198, mae:0.31748759746551514
	iters: 1000, cost time: 231.81079530715942s
[]
mse:0.22332414984703064, mae:0.3207555413246155
	iters: 1100, cost time: 258.81852650642395s
[]
mse:0.22527948021888733, mae:0.3214813768863678
	iters: 1200, cost time: 286.12780714035034s
[]
mse:0.21920518577098846, mae:0.31741634011268616
	iters: 1300, cost time: 311.6533763408661s
[]
mse:0.2177538275718689, mae:0.31498438119888306
	iters: 1400, cost time: 338.15308237075806s
[]
mse:0.2281494438648224, mae:0.31592488288879395
	iters: 1500, cost time: 365.22301268577576s
[]
mse:0.2739693224430084, mae:0.3300975263118744
	iters: 1600, cost time: 390.36925625801086s
[]
mse:0.2845243215560913, mae:0.3350514769554138
	iters: 1700, cost time: 414.3123059272766s
[]
mse:0.2770903408527374, mae:0.33189618587493896
	iters: 1800, cost time: 437.9240686893463s
[]
mse:0.27679410576820374, mae:0.33116382360458374
	iters: 1900, cost time: 461.0562205314636s
[]
mse:0.2817135751247406, mae:0.3378917872905731
	iters: 2000, cost time: 483.6783308982849s
[]
mse:0.2785809636116028, mae:0.33758625388145447
	iters: 2100, cost time: 506.20652055740356s
[]
mse:0.28595486283302307, mae:0.34474653005599976
	iters: 2200, cost time: 530.6900932788849s
[]
mse:0.27947354316711426, mae:0.3416897654533386
	iters: 2300, cost time: 555.1702582836151s
[]
mse:0.2802060544490814, mae:0.34471893310546875
	iters: 2400, cost time: 579.1290137767792s
[]
mse:0.28212770819664, mae:0.3480950891971588
	iters: 2500, cost time: 603.2538661956787s
[]
mse:0.2786462903022766, mae:0.34717604517936707
	iters: 2600, cost time: 627.6187167167664s
[]
mse:0.2756863832473755, mae:0.34654393792152405
	iters: 2700, cost time: 651.4162135124207s
[]
mse:0.27614521980285645, mae:0.3486650884151459
	iters: 2800, cost time: 675.2880659103394s
[]
mse:0.27280277013778687, mae:0.3477555811405182
	iters: 2900, cost time: 699.7717127799988s
[]
mse:0.2688100039958954, mae:0.345794141292572
	iters: 3000, cost time: 722.991758108139s
[]
mse:0.2689127027988434, mae:0.34693005681037903
	iters: 3100, cost time: 747.0398194789886s
[]
mse:0.266496479511261, mae:0.3453527092933655
	iters: 3200, cost time: 771.211216211319s
[]
mse:0.26574620604515076, mae:0.34490785002708435
	iters: 3300, cost time: 795.7483694553375s
[]
mse:0.26775240898132324, mae:0.34709399938583374
	iters: 3400, cost time: 820.494907617569s
[]
mse:0.2657471001148224, mae:0.3458717465400696
	iters: 3500, cost time: 848.1061153411865s
[]
mse:0.2623990476131439, mae:0.3441205620765686
	iters: 3600, cost time: 877.1174812316895s
[]
mse:0.26219120621681213, mae:0.34532231092453003
	iters: 3700, cost time: 903.6842555999756s
[]
mse:0.259402871131897, mae:0.3439226448535919
	iters: 3800, cost time: 930.9617247581482s
[]
mse:0.25722071528434753, mae:0.34308376908302307
	iters: 3900, cost time: 958.8777341842651s
[]
mse:0.2570037841796875, mae:0.3421614468097687
	iters: 4000, cost time: 985.8639023303986s
[]
mse:0.2554396092891693, mae:0.34073325991630554
	iters: 4100, cost time: 1011.0067181587219s
[]
mse:0.25275954604148865, mae:0.33884137868881226
	iters: 4200, cost time: 1035.2522377967834s
[]
mse:0.24981260299682617, mae:0.33685585856437683
	iters: 4300, cost time: 1058.9160678386688s
[]
mse:0.24822896718978882, mae:0.33631813526153564
	iters: 4400, cost time: 1083.142323255539s
[]
mse:0.24744515120983124, mae:0.33548036217689514
	iters: 4500, cost time: 1107.917207479477s
[]
mse:0.2473277896642685, mae:0.3351028859615326
	iters: 4600, cost time: 1132.7410476207733s
[]
mse:0.24751275777816772, mae:0.33553847670555115
	iters: 4700, cost time: 1158.1670696735382s
[]
mse:0.2474621683359146, mae:0.33574435114860535
	iters: 4800, cost time: 1182.9285695552826s
[]
mse:0.2481512427330017, mae:0.3370369076728821
	iters: 4900, cost time: 1207.0015473365784s
[]
mse:0.24874240159988403, mae:0.33712270855903625
	iters: 5000, cost time: 1231.3523752689362s
[]
mse:0.24868661165237427, mae:0.3366437554359436
	iters: 5100, cost time: 1255.8058927059174s
[]
mse:0.24925768375396729, mae:0.33781319856643677
	iters: 5200, cost time: 1280.8627812862396s
[]
mse:0.2478669434785843, mae:0.3373938202857971
	iters: 5300, cost time: 1305.3447835445404s
[]
mse:0.24575422704219818, mae:0.3360019028186798
	iters: 5400, cost time: 1329.12859249115s
[]
mse:0.24493283033370972, mae:0.3355381488800049
	iters: 5500, cost time: 1353.9553427696228s
[]
mse:0.24308231472969055, mae:0.3340778648853302
	iters: 5600, cost time: 1379.0259008407593s
[]
mse:0.24199743568897247, mae:0.3332235813140869
	iters: 5700, cost time: 1403.187143087387s
[]
mse:0.2406967729330063, mae:0.332231342792511
	iters: 5800, cost time: 1429.8757982254028s
[]
mse:0.24055716395378113, mae:0.33194828033447266
	iters: 5900, cost time: 1459.2506093978882s
[]
mse:0.2399827241897583, mae:0.3313608467578888
	iters: 6000, cost time: 1487.5886189937592s
[]
mse:0.23980794847011566, mae:0.33093029260635376
	iters: 6100, cost time: 1516.2847564220428s
[]
mse:0.24308061599731445, mae:0.3311872184276581
	iters: 6200, cost time: 1543.6492762565613s
[]
mse:0.2425260990858078, mae:0.33075782656669617
	iters: 6300, cost time: 1572.0451154708862s
[]
mse:0.2438245415687561, mae:0.3315545916557312
	iters: 6400, cost time: 1599.0915715694427s
[]
mse:0.2449939101934433, mae:0.3323308527469635
	iters: 6500, cost time: 1625.9251790046692s
[]
mse:0.24385333061218262, mae:0.33146923780441284
	iters: 6600, cost time: 1653.0102181434631s
[]
mse:0.24257010221481323, mae:0.33058223128318787
	iters: 6700, cost time: 1677.411211490631s
[]
mse:0.24109593033790588, mae:0.32934749126434326
	iters: 6800, cost time: 1701.8720808029175s
[]
mse:0.24076451361179352, mae:0.32892563939094543
	iters: 6900, cost time: 1726.3376004695892s
[]
mse:0.24009598791599274, mae:0.328774631023407
	iters: 7000, cost time: 1750.8821065425873s
[]
mse:0.23979613184928894, mae:0.3283438980579376
	iters: 7100, cost time: 1774.954529285431s
[]
mse:0.23907727003097534, mae:0.32776856422424316
	iters: 7200, cost time: 1798.4507012367249s
[]
mse:0.2398645281791687, mae:0.32833606004714966
	iters: 7300, cost time: 1822.7548353672028s
[]
mse:0.2449718415737152, mae:0.3302854299545288
	iters: 7400, cost time: 1847.3173484802246s
[]
mse:0.24858514964580536, mae:0.33062922954559326
	iters: 7500, cost time: 1871.6155316829681s
[]
mse:0.24976123869419098, mae:0.33133915066719055
	iters: 7600, cost time: 1895.9667172431946s
[]
mse:0.2499247044324875, mae:0.33178335428237915
	iters: 7700, cost time: 1920.1081392765045s
[]
mse:0.25007349252700806, mae:0.3309208154678345
	iters: 7800, cost time: 1945.0993673801422s
[]
mse:0.24928992986679077, mae:0.3305469751358032
	iters: 7900, cost time: 1969.3759293556213s
[]
mse:0.2494155764579773, mae:0.3309876322746277
	iters: 8000, cost time: 1994.1296479701996s
[]
mse:0.24804221093654633, mae:0.3298061490058899
	iters: 8100, cost time: 2019.2066311836243s
[]
mse:0.2468993067741394, mae:0.32901784777641296
	iters: 8200, cost time: 2043.9396088123322s
[]
mse:0.24773633480072021, mae:0.32888421416282654
	iters: 8300, cost time: 2069.103753566742s
[]
mse:0.2467353343963623, mae:0.3286604583263397
	iters: 8400, cost time: 2093.4443135261536s
[]
mse:0.2457675188779831, mae:0.3281140625476837
	iters: 8500, cost time: 2120.050610780716s
[]
mse:0.24459786713123322, mae:0.3275901973247528
	iters: 8600, cost time: 2148.026301383972s
[]
mse:0.24374279379844666, mae:0.3273162543773651
	iters: 8700, cost time: 2175.695656776428s
[]
mse:0.24269844591617584, mae:0.3267904818058014
	iters: 8800, cost time: 2204.2510554790497s
[]
mse:0.24155229330062866, mae:0.3261163532733917
	iters: 8900, cost time: 2233.1846673488617s
[]
mse:0.24168436229228973, mae:0.3258638083934784
	iters: 9000, cost time: 2261.6574618816376s
[]
mse:0.2414906620979309, mae:0.32547542452812195
	iters: 9100, cost time: 2288.8119127750397s
[]
mse:0.2445453405380249, mae:0.32708510756492615
	iters: 9200, cost time: 2313.878347158432s
[]
mse:0.2471219301223755, mae:0.3289172351360321
	iters: 9300, cost time: 2338.7679176330566s
[]
mse:0.2505265772342682, mae:0.32919952273368835
	iters: 9400, cost time: 2362.8932387828827s
[]
mse:0.2534579634666443, mae:0.3305712938308716
	iters: 9500, cost time: 2387.111252307892s
[]
mse:0.2551296651363373, mae:0.33164525032043457
	iters: 9600, cost time: 2412.0749731063843s
[]
mse:0.2560522258281708, mae:0.33175766468048096
	iters: 9700, cost time: 2436.570652484894s
[]
mse:0.2551001310348511, mae:0.3312210440635681
	iters: 9800, cost time: 2462.1093735694885s
[]
mse:0.25652870535850525, mae:0.3316539227962494
	iters: 9900, cost time: 2486.5805053710938s
[]
mse:0.25818148255348206, mae:0.33218175172805786
	iters: 10000, cost time: 2511.6074867248535s
[]
mse:0.2596266567707062, mae:0.3329598307609558
	iters: 10100, cost time: 2536.3511147499084s
[]
mse:0.2616811692714691, mae:0.333265483379364
	iters: 10200, cost time: 2561.1330037117004s
[]
mse:0.2613549828529358, mae:0.3330007791519165
	iters: 10300, cost time: 2585.5453197956085s
[]
mse:0.2599073052406311, mae:0.33209556341171265
	iters: 10400, cost time: 2610.738755941391s
[]
mse:0.2587527334690094, mae:0.3313555419445038
[0.18449456918257356, 0.19274231873071718, 0.1934018869366128, 0.19571362336630616, 0.1993040634439659, 0.20327895022160045, 0.20801223506938776, 0.21334497718039183, 0.21890646291902766, 0.22517127533976883, 0.23127858000982243, 0.2358124452282481, 0.23817473489904226, 0.23782334017174261, 0.23686896458183274, 0.2361817329553784, 0.2364198703539805, 0.23759172425165911, 0.23925826257251329, 0.24171172061941132, 0.24393873943676883, 0.24599388120657603, 0.24800570536223293, 0.2501066609330626, 0.2520442667937285, 0.25391147180671914, 0.2558091455994834, 0.25770396436395193, 0.2590646055334953, 0.26000072201624747, 0.26046259825706247, 0.26064011673542004, 0.2604495665163807, 0.2600770956872845, 0.2599266102104667, 0.259832978464261, 0.259617864976677, 0.2593179402132963, 0.25930192031833754, 0.2593202022352295, 0.25964528284887584, 0.26016115736326345, 0.26071479600646086, 0.2612248971706598, 0.2619870980005809, 0.2624816103294964, 0.26299190778695997, 0.26355820125086504, 0.2641470523468889, 0.2648414267153575, 0.26522324299499533, 0.2655413001653575, 0.26582172503912477, 0.266068636542245, 0.2665236276165218, 0.2669598725067943, 0.2674332781103969, 0.26792515786446713, 0.26829749725272856, 0.26869512446284793, 0.2692402659414057, 0.2696635346744304, 0.2701194951302193, 0.27038761707462766, 0.27058906623027945, 0.2705275748800142, 0.27044570548465235, 0.2699562023585175, 0.26927591697870223, 0.2685821710398035, 0.26843105878307133, 0.26877003127314175, 0.26896540462845536, 0.2689648642539457, 0.26911415462680865, 0.2694668413274263, 0.26991789351929585, 0.27030227971750115, 0.27093303380426154, 0.2716486166417349, 0.27225898933653625, 0.27278997303532954, 0.2730779657163113, 0.27327739235226134, 0.2738984789187374, 0.2747829524234468, 0.27590159416419524, 0.2775883607986183, 0.2800705316875127, 0.28351036971055965, 0.28752830899848447, 0.2921342563372047, 0.2966002315734572, 0.30287680254674154, 0.3115827126552168, 0.31343627115288]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.25810277462005615, mae:0.33090054988861084
Test - cost time: 2622.829419851303s
