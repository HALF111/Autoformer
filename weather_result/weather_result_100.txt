Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=100)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 22.37087655067444s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 23.777154207229614s
[]
mse:0.32634487748146057, mae:0.4058026075363159
	iters: 200, cost time: 45.97550702095032s
[]
mse:0.29679128527641296, mae:0.3882945477962494
	iters: 300, cost time: 68.44561886787415s
[]
mse:0.2630135416984558, mae:0.36854287981987
	iters: 400, cost time: 93.23431420326233s
[]
mse:0.24894244968891144, mae:0.3626485764980316
	iters: 500, cost time: 119.1151294708252s
[]
mse:0.22961737215518951, mae:0.34942924976348877
	iters: 600, cost time: 144.762122631073s
[]
mse:0.22075043618679047, mae:0.340096116065979
	iters: 700, cost time: 169.97004532814026s
[]
mse:0.21738624572753906, mae:0.3339267671108246
	iters: 800, cost time: 194.23315691947937s
[]
mse:0.20654107630252838, mae:0.32349056005477905
	iters: 900, cost time: 218.56685400009155s
[]
mse:0.20985309779644012, mae:0.31747549772262573
	iters: 1000, cost time: 242.589026927948s
[]
mse:0.22369098663330078, mae:0.3208737373352051
	iters: 1100, cost time: 265.7493679523468s
[]
mse:0.22597594559192657, mae:0.32178589701652527
	iters: 1200, cost time: 288.6787385940552s
[]
mse:0.21983450651168823, mae:0.3177049160003662
	iters: 1300, cost time: 311.47715520858765s
[]
mse:0.21834540367126465, mae:0.31524404883384705
	iters: 1400, cost time: 333.98617601394653s
[]
mse:0.22871047258377075, mae:0.3162895739078522
	iters: 1500, cost time: 356.7923047542572s
[]
mse:0.27479860186576843, mae:0.33057600259780884
	iters: 1600, cost time: 380.34642934799194s
[]
mse:0.2858161926269531, mae:0.3355715870857239
	iters: 1700, cost time: 404.5647621154785s
[]
mse:0.2783966064453125, mae:0.3324393332004547
	iters: 1800, cost time: 428.4904508590698s
[]
mse:0.27803686261177063, mae:0.33166971802711487
	iters: 1900, cost time: 452.5731828212738s
[]
mse:0.28296175599098206, mae:0.3384098410606384
	iters: 2000, cost time: 475.7760238647461s
[]
mse:0.27979549765586853, mae:0.3380516469478607
	iters: 2100, cost time: 499.5364546775818s
[]
mse:0.28719520568847656, mae:0.34518492221832275
	iters: 2200, cost time: 522.6020882129669s
[]
mse:0.2806408107280731, mae:0.34206584095954895
	iters: 2300, cost time: 546.0680193901062s
[]
mse:0.28129857778549194, mae:0.34505125880241394
	iters: 2400, cost time: 569.7633776664734s
[]
mse:0.2831536829471588, mae:0.3483879864215851
	iters: 2500, cost time: 593.862251996994s
[]
mse:0.2796749770641327, mae:0.34749212861061096
	iters: 2600, cost time: 617.6114733219147s
[]
mse:0.2766726315021515, mae:0.34683936834335327
	iters: 2700, cost time: 641.4493329524994s
[]
mse:0.27711454033851624, mae:0.348954975605011
	iters: 2800, cost time: 666.3777391910553s
[]
mse:0.2737381160259247, mae:0.34802117943763733
	iters: 2900, cost time: 692.3569087982178s
[]
mse:0.2697164714336395, mae:0.346035897731781
	iters: 3000, cost time: 719.2152609825134s
[]
mse:0.2698141634464264, mae:0.3471609652042389
	iters: 3100, cost time: 746.4832098484039s
[]
mse:0.26738226413726807, mae:0.34556928277015686
	iters: 3200, cost time: 773.6992383003235s
[]
mse:0.2666000425815582, mae:0.34510254859924316
	iters: 3300, cost time: 799.5414385795593s
[]
mse:0.26860275864601135, mae:0.3472825288772583
	iters: 3400, cost time: 825.7423725128174s
[]
mse:0.26658448576927185, mae:0.34606751799583435
	iters: 3500, cost time: 851.6341342926025s
[]
mse:0.26322445273399353, mae:0.3443089425563812
	iters: 3600, cost time: 877.3789477348328s
[]
mse:0.26300284266471863, mae:0.3455004096031189
	iters: 3700, cost time: 903.6935179233551s
[]
mse:0.2601899802684784, mae:0.34407323598861694
	iters: 3800, cost time: 929.2139909267426s
[]
mse:0.25801458954811096, mae:0.343264102935791
	iters: 3900, cost time: 954.6020007133484s
[]
mse:0.25778433680534363, mae:0.3423396050930023
	iters: 4000, cost time: 978.2440574169159s
[]
mse:0.2562227249145508, mae:0.34091538190841675
	iters: 4100, cost time: 1002.6629922389984s
[]
mse:0.25353696942329407, mae:0.3390212953090668
	iters: 4200, cost time: 1028.0853395462036s
[]
mse:0.250584214925766, mae:0.3370150923728943
	iters: 4300, cost time: 1054.807869195938s
[]
mse:0.2489873766899109, mae:0.33646807074546814
	iters: 4400, cost time: 1081.0540788173676s
[]
mse:0.24818018078804016, mae:0.3356105387210846
	iters: 4500, cost time: 1107.5609374046326s
[]
mse:0.24807867407798767, mae:0.3352433741092682
	iters: 4600, cost time: 1133.204036951065s
[]
mse:0.24822835624217987, mae:0.3356626033782959
	iters: 4700, cost time: 1157.8448073863983s
[]
mse:0.2481759786605835, mae:0.3358669579029083
	iters: 4800, cost time: 1181.9587244987488s
[]
mse:0.24885161221027374, mae:0.33714404702186584
	iters: 4900, cost time: 1206.9091680049896s
[]
mse:0.24943381547927856, mae:0.33720162510871887
	iters: 5000, cost time: 1230.7734615802765s
[]
mse:0.24938641488552094, mae:0.33672836422920227
	iters: 5100, cost time: 1255.2299540042877s
[]
mse:0.249965101480484, mae:0.33791157603263855
	iters: 5200, cost time: 1279.7529435157776s
[]
mse:0.24855752289295197, mae:0.33748507499694824
	iters: 5300, cost time: 1304.4123392105103s
[]
mse:0.24642416834831238, mae:0.33607247471809387
	iters: 5400, cost time: 1329.0071113109589s
[]
mse:0.24559509754180908, mae:0.3356071710586548
	iters: 5500, cost time: 1355.9026217460632s
[]
mse:0.24372602999210358, mae:0.33413127064704895
	iters: 5600, cost time: 1382.4884543418884s
[]
mse:0.2426212877035141, mae:0.33326247334480286
	iters: 5700, cost time: 1411.9247040748596s
[]
mse:0.2413061559200287, mae:0.33225876092910767
	iters: 5800, cost time: 1442.1157557964325s
[]
mse:0.24116329848766327, mae:0.33196696639060974
	iters: 5900, cost time: 1471.1907448768616s
[]
mse:0.24060730636119843, mae:0.33138054609298706
	iters: 6000, cost time: 1498.603882074356s
[]
mse:0.2404296100139618, mae:0.3309422433376312
	iters: 6100, cost time: 1523.4141182899475s
[]
mse:0.24369052052497864, mae:0.3311920762062073
	iters: 6200, cost time: 1547.9920897483826s
[]
mse:0.2431764304637909, mae:0.33076345920562744
	iters: 6300, cost time: 1572.0873129367828s
[]
mse:0.24448160827159882, mae:0.3315664827823639
	iters: 6400, cost time: 1596.3092679977417s
[]
mse:0.24564684927463531, mae:0.33233702182769775
	iters: 6500, cost time: 1621.128038406372s
[]
mse:0.24448387324810028, mae:0.33147427439689636
	iters: 6600, cost time: 1645.3516144752502s
[]
mse:0.24318931996822357, mae:0.33057889342308044
	iters: 6700, cost time: 1670.3809518814087s
[]
mse:0.24171090126037598, mae:0.3293388783931732
	iters: 6800, cost time: 1694.6706461906433s
[]
mse:0.2413625866174698, mae:0.32890352606773376
	iters: 6900, cost time: 1718.7330935001373s
[]
mse:0.24069638550281525, mae:0.32875701785087585
	iters: 7000, cost time: 1743.122286081314s
[]
mse:0.24039356410503387, mae:0.3283194899559021
	iters: 7100, cost time: 1769.0899455547333s
[]
mse:0.23966455459594727, mae:0.327725350856781
	iters: 7200, cost time: 1796.0408313274384s
[]
mse:0.24046120047569275, mae:0.3282957971096039
	iters: 7300, cost time: 1823.221551656723s
[]
mse:0.24556663632392883, mae:0.3302426338195801
	iters: 7400, cost time: 1850.0235557556152s
[]
mse:0.24919575452804565, mae:0.3305812478065491
	iters: 7500, cost time: 1874.1906764507294s
[]
mse:0.2504424750804901, mae:0.33131492137908936
	iters: 7600, cost time: 1899.9221076965332s
[]
mse:0.2506084144115448, mae:0.331758588552475
	iters: 7700, cost time: 1925.0501899719238s
[]
mse:0.2507534921169281, mae:0.3308951258659363
	iters: 7800, cost time: 1953.7626061439514s
[]
mse:0.24997785687446594, mae:0.33052539825439453
	iters: 7900, cost time: 1980.2208135128021s
[]
mse:0.2500912547111511, mae:0.330962210893631
	iters: 8000, cost time: 2007.0980355739594s
[]
mse:0.24870963394641876, mae:0.3297770321369171
	iters: 8100, cost time: 2033.8415517807007s
[]
mse:0.24755391478538513, mae:0.3289795219898224
	iters: 8200, cost time: 2060.7646040916443s
[]
mse:0.24838875234127045, mae:0.3288528025150299
	iters: 8300, cost time: 2087.1456587314606s
[]
mse:0.24740000069141388, mae:0.3286275565624237
	iters: 8400, cost time: 2114.1841309070587s
[]
mse:0.24642927944660187, mae:0.32808464765548706
	iters: 8500, cost time: 2141.225344181061s
[]
mse:0.24525140225887299, mae:0.3275526463985443
	iters: 8600, cost time: 2168.418176651001s
[]
mse:0.24439023435115814, mae:0.3272762894630432
	iters: 8700, cost time: 2195.630946159363s
[]
mse:0.24334165453910828, mae:0.32675081491470337
	iters: 8800, cost time: 2220.5175619125366s
[]
mse:0.24218769371509552, mae:0.3260704278945923
	iters: 8900, cost time: 2245.0102903842926s
[]
mse:0.2423144280910492, mae:0.32581666111946106
	iters: 9000, cost time: 2269.0799095630646s
[]
mse:0.2421167939901352, mae:0.3254269063472748
	iters: 9100, cost time: 2294.0689685344696s
[]
mse:0.24518606066703796, mae:0.3270494043827057
	iters: 9200, cost time: 2318.7101452350616s
[]
mse:0.24781514704227448, mae:0.3289302587509155
	iters: 9300, cost time: 2343.1391508579254s
[]
mse:0.25123146176338196, mae:0.32922062277793884
	iters: 9400, cost time: 2368.3325641155243s
[]
mse:0.25418639183044434, mae:0.33060693740844727
	iters: 9500, cost time: 2392.6903965473175s
[]
mse:0.25588852167129517, mae:0.3316997289657593
	iters: 9600, cost time: 2416.9367463588715s
[]
mse:0.25683021545410156, mae:0.33181315660476685
	iters: 9700, cost time: 2441.551060438156s
[]
mse:0.25587454438209534, mae:0.33127230405807495
	iters: 9800, cost time: 2467.5167286396027s
[]
mse:0.25729262828826904, mae:0.3316988945007324
	iters: 9900, cost time: 2494.710018157959s
[]
mse:0.25893041491508484, mae:0.3322174549102783
	iters: 10000, cost time: 2522.120562314987s
[]
mse:0.26035788655281067, mae:0.33298459649086
	iters: 10100, cost time: 2552.3832001686096s
[]
mse:0.2623978853225708, mae:0.3332773745059967
	iters: 10200, cost time: 2581.662199497223s
[]
mse:0.2620849907398224, mae:0.3330188989639282
	iters: 10300, cost time: 2610.8347342014313s
[]
mse:0.26063409447669983, mae:0.33211106061935425
	iters: 10400, cost time: 2637.759497642517s
[]
mse:0.25947123765945435, mae:0.3313679099082947
[0.18444183653874885, 0.1927953618027524, 0.19352776733158766, 0.1958987655080031, 0.1995725117764075, 0.20363634718373905, 0.20841906477769603, 0.21382356008336595, 0.21945204964365592, 0.22572730816451297, 0.23182553331960137, 0.23636316653870384, 0.23873293968217182, 0.23833671931010803, 0.23736458519192422, 0.23675209617277707, 0.23696553333269554, 0.23816827894625411, 0.2399259782943779, 0.2424723793822403, 0.2448088664134193, 0.24694381132542664, 0.24895639611231196, 0.2510683270525658, 0.25298382790910084, 0.25481534734591615, 0.25667858980312497, 0.2585508688633897, 0.2597914851214972, 0.26061955076935356, 0.26097845722909063, 0.26104692137131896, 0.26084863319531104, 0.2605617895031477, 0.2605490936149623, 0.26057069714700826, 0.260387244578508, 0.2601920228623327, 0.2602995494751999, 0.2603364670698216, 0.2607523159234799, 0.2612302153070227, 0.26169732363022646, 0.2620861076670319, 0.2627518061862895, 0.26319708049535245, 0.2636728193725048, 0.26418062062633174, 0.26470064253085984, 0.26534396817125466, 0.26567923612933647, 0.2660066138018705, 0.26635599835798623, 0.26679415377626486, 0.2673811948158996, 0.2679174469597263, 0.26844597584835483, 0.26892322014535913, 0.26930021937040893, 0.26967074143524095, 0.27014159614417155, 0.2705518555216069, 0.27096842737875204, 0.2711763532009377, 0.2713528631776871, 0.27134091160624413, 0.27130723405193874, 0.2708669967830077, 0.2702155180786134, 0.26960725579844175, 0.2694423394496612, 0.26969668086713955, 0.26978499241307385, 0.2696585386260907, 0.2696978344300413, 0.2700036746675911, 0.2704710859780555, 0.27088769134943746, 0.2715539089521309, 0.2723417543534693, 0.27309446975673335, 0.2738328901305367, 0.27423492771091296, 0.27450666980706806, 0.27516093788022367, 0.2759959214099097, 0.27712766060032085, 0.2787654623653196, 0.28123163116616257, 0.2846474075462164, 0.28848951200905393, 0.29281833215905745, 0.2968672900716587, 0.3027132876674466, 0.31149073113266973, 0.31341976034128627]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.2588202953338623, mae:0.3309120833873749
Test - cost time: 2650.2290930747986s
