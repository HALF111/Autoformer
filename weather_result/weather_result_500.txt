Args in experiment:
Namespace(is_training=1, model_id='weather_96_96', model='Autoformer', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=21, dec_in=21, c_out=21, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=2, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=3, use_multi_gpu=False, devices='0,1,2,3', test_train_num=10, adapted_lr_times=500)
-------Start iteration 1--------------------------
Use GPU: cuda:3
>>>>>>>normal testing : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
test shape: (326, 32, 96, 21) (326, 32, 96, 21)
test shape: (10432, 96, 21) (10432, 96, 21)
mse:0.2584741413593292, mae:0.33147692680358887
Test - cost time: 28.875122547149658s
>>>>>>>my testing with test-time training : weather_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_ttn10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
loading model from checkpoint !!!
	iters: 100, cost time: 23.850640296936035s
[]
mse:0.3295876979827881, mae:0.40841230750083923
	iters: 200, cost time: 47.34518337249756s
[]
mse:0.29895150661468506, mae:0.3884453773498535
	iters: 300, cost time: 72.12776279449463s
[]
mse:0.2642858326435089, mae:0.3679823577404022
	iters: 400, cost time: 97.44044137001038s
[]
mse:0.24935944378376007, mae:0.36161497235298157
	iters: 500, cost time: 124.73145961761475s
[]
mse:0.23045384883880615, mae:0.3487522304058075
	iters: 600, cost time: 151.19297337532043s
[]
mse:0.22169876098632812, mae:0.3396698236465454
	iters: 700, cost time: 177.38784790039062s
[]
mse:0.21860119700431824, mae:0.3339676260948181
	iters: 800, cost time: 202.47574305534363s
[]
mse:0.20785188674926758, mae:0.3237532675266266
	iters: 900, cost time: 227.28475880622864s
[]
mse:0.21124210953712463, mae:0.3178254961967468
	iters: 1000, cost time: 252.90613842010498s
[]
mse:0.2256024032831192, mae:0.32170331478118896
	iters: 1100, cost time: 278.8339653015137s
[]
mse:0.2288447916507721, mae:0.3231803774833679
	iters: 1200, cost time: 304.0608069896698s
[]
mse:0.2225559651851654, mae:0.3191435635089874
	iters: 1300, cost time: 329.5465393066406s
[]
mse:0.22097617387771606, mae:0.31662577390670776
	iters: 1400, cost time: 354.8110501766205s
[]
mse:0.2313080132007599, mae:0.3180271089076996
	iters: 1500, cost time: 379.4805278778076s
[]
mse:0.2780623733997345, mae:0.33266332745552063
	iters: 1600, cost time: 403.79620480537415s
[]
mse:0.290446937084198, mae:0.3377387821674347
	iters: 1700, cost time: 427.4991385936737s
[]
mse:0.28310808539390564, mae:0.334711492061615
	iters: 1800, cost time: 451.20962619781494s
[]
mse:0.2826389968395233, mae:0.33391350507736206
	iters: 1900, cost time: 473.675763130188s
[]
mse:0.28764185309410095, mae:0.34074077010154724
	iters: 2000, cost time: 497.01512718200684s
[]
mse:0.2843690514564514, mae:0.34027808904647827
	iters: 2100, cost time: 519.9422559738159s
[]
mse:0.2919063866138458, mae:0.34742245078086853
	iters: 2200, cost time: 543.0211873054504s
[]
mse:0.2850883901119232, mae:0.3440917432308197
	iters: 2300, cost time: 566.2688021659851s
[]
mse:0.2854384481906891, mae:0.34687864780426025
	iters: 2400, cost time: 589.2161819934845s
[]
mse:0.28703901171684265, mae:0.3500332534313202
	iters: 2500, cost time: 612.4241034984589s
[]
mse:0.28356486558914185, mae:0.3491964340209961
	iters: 2600, cost time: 635.7281632423401s
[]
mse:0.28043046593666077, mae:0.3484680950641632
	iters: 2700, cost time: 658.8141741752625s
[]
mse:0.28086918592453003, mae:0.35059869289398193
	iters: 2800, cost time: 682.2958557605743s
[]
mse:0.27743586897850037, mae:0.34964147210121155
	iters: 2900, cost time: 705.5864496231079s
[]
mse:0.2733672261238098, mae:0.3476632535457611
	iters: 3000, cost time: 729.6761243343353s
[]
mse:0.27348750829696655, mae:0.34881919622421265
	iters: 3100, cost time: 754.557391166687s
[]
mse:0.27107468247413635, mae:0.3472549021244049
	iters: 3200, cost time: 779.4388983249664s
[]
mse:0.2702687382698059, mae:0.34679409861564636
	iters: 3300, cost time: 805.2622253894806s
[]
mse:0.27219560742378235, mae:0.34890586137771606
	iters: 3400, cost time: 830.8345899581909s
[]
mse:0.2701672613620758, mae:0.34775087237358093
	iters: 3500, cost time: 856.7691555023193s
[]
mse:0.2668052613735199, mae:0.3460334837436676
	iters: 3600, cost time: 882.6124513149261s
[]
mse:0.2665734887123108, mae:0.3472258448600769
	iters: 3700, cost time: 908.7254076004028s
[]
mse:0.2637055814266205, mae:0.3457687795162201
	iters: 3800, cost time: 934.6230664253235s
[]
mse:0.26153135299682617, mae:0.3450022339820862
	iters: 3900, cost time: 960.5824558734894s
[]
mse:0.2612341642379761, mae:0.3440493941307068
	iters: 4000, cost time: 984.9048981666565s
[]
mse:0.25971895456314087, mae:0.3426993191242218
	iters: 4100, cost time: 1008.7273032665253s
[]
mse:0.2570340931415558, mae:0.34082284569740295
	iters: 4200, cost time: 1032.5629394054413s
[]
mse:0.2540302872657776, mae:0.3387391269207001
	iters: 4300, cost time: 1057.9615836143494s
[]
mse:0.2524060606956482, mae:0.3381895422935486
	iters: 4400, cost time: 1082.4958457946777s
[]
mse:0.25150880217552185, mae:0.33726757764816284
	iters: 4500, cost time: 1107.2054660320282s
[]
mse:0.2514605224132538, mae:0.33696258068084717
	iters: 4600, cost time: 1137.2938315868378s
[]
mse:0.25148242712020874, mae:0.3372850716114044
	iters: 4700, cost time: 1163.0668709278107s
[]
mse:0.25140872597694397, mae:0.33746883273124695
	iters: 4800, cost time: 1187.0430641174316s
[]
mse:0.25205469131469727, mae:0.3387049436569214
	iters: 4900, cost time: 1210.6975071430206s
[]
mse:0.2526331841945648, mae:0.3387089669704437
	iters: 5000, cost time: 1239.0122330188751s
[]
mse:0.2526143491268158, mae:0.3382655382156372
	iters: 5100, cost time: 1262.7063663005829s
[]
mse:0.25324547290802, mae:0.3395233154296875
	iters: 5200, cost time: 1286.508986711502s
[]
mse:0.25182607769966125, mae:0.33911606669425964
	iters: 5300, cost time: 1310.6816096305847s
[]
mse:0.24964840710163116, mae:0.33768430352211
	iters: 5400, cost time: 1334.243328332901s
[]
mse:0.24880963563919067, mae:0.3372206687927246
	iters: 5500, cost time: 1357.9144268035889s
[]
mse:0.24690207839012146, mae:0.33573269844055176
	iters: 5600, cost time: 1381.8121576309204s
[]
mse:0.2457699328660965, mae:0.33487075567245483
	iters: 5700, cost time: 1407.8316416740417s
[]
mse:0.24441663920879364, mae:0.3338417112827301
	iters: 5800, cost time: 1433.5234050750732s
[]
mse:0.24427944421768188, mae:0.3335513174533844
	iters: 5900, cost time: 1459.3093910217285s
[]
mse:0.24371454119682312, mae:0.33295923471450806
	iters: 6000, cost time: 1486.6588797569275s
[]
mse:0.24352878332138062, mae:0.3325084447860718
	iters: 6100, cost time: 1514.1066720485687s
[]
mse:0.24675703048706055, mae:0.3327421545982361
	iters: 6200, cost time: 1540.2577168941498s
[]
mse:0.24646519124507904, mae:0.33237317204475403
	iters: 6300, cost time: 1564.565034866333s
[]
mse:0.24779939651489258, mae:0.33320584893226624
	iters: 6400, cost time: 1588.192286491394s
[]
mse:0.24896864593029022, mae:0.3339686393737793
	iters: 6500, cost time: 1611.8146228790283s
[]
mse:0.2477264702320099, mae:0.3331015408039093
	iters: 6600, cost time: 1636.0128445625305s
[]
mse:0.24636758863925934, mae:0.3321637809276581
	iters: 6700, cost time: 1659.848795413971s
[]
mse:0.2448764145374298, mae:0.330925852060318
	iters: 6800, cost time: 1683.6211965084076s
[]
mse:0.2444864958524704, mae:0.3304561972618103
	iters: 6900, cost time: 1708.0010373592377s
[]
mse:0.2438499480485916, mae:0.3303379416465759
	iters: 7000, cost time: 1731.7376153469086s
[]
mse:0.2435435801744461, mae:0.32989805936813354
	iters: 7100, cost time: 1756.8754110336304s
[]
mse:0.24280790984630585, mae:0.3292854428291321
	iters: 7200, cost time: 1781.5363256931305s
[]
mse:0.24364829063415527, mae:0.329878568649292
	iters: 7300, cost time: 1806.4672718048096s
[]
mse:0.2487075924873352, mae:0.33179813623428345
	iters: 7400, cost time: 1830.9832019805908s
[]
mse:0.25243720412254333, mae:0.3321656584739685
	iters: 7500, cost time: 1854.817544221878s
[]
mse:0.25402194261550903, mae:0.33301231265068054
	iters: 7600, cost time: 1878.85427236557s
[]
mse:0.2542068660259247, mae:0.33344385027885437
	iters: 7700, cost time: 1902.518863916397s
[]
mse:0.2543467581272125, mae:0.3325963318347931
	iters: 7800, cost time: 1926.127776145935s
[]
mse:0.25360918045043945, mae:0.3322548270225525
	iters: 7900, cost time: 1950.3149478435516s
[]
mse:0.2536501884460449, mae:0.33265116810798645
	iters: 8000, cost time: 1974.104187965393s
[]
mse:0.2522510588169098, mae:0.33148398995399475
	iters: 8100, cost time: 1998.2338178157806s
[]
mse:0.25104230642318726, mae:0.33065351843833923
	iters: 8200, cost time: 2023.7816326618195s
[]
mse:0.2518683671951294, mae:0.33052757382392883
	iters: 8300, cost time: 2049.580025434494s
[]
mse:0.2508854568004608, mae:0.33028945326805115
	iters: 8400, cost time: 2075.9077336788177s
[]
mse:0.24991169571876526, mae:0.3297680616378784
	iters: 8500, cost time: 2102.48344540596s
[]
mse:0.24871014058589935, mae:0.32921940088272095
	iters: 8600, cost time: 2130.6830632686615s
[]
mse:0.24782420694828033, mae:0.3289310038089752
	iters: 8700, cost time: 2159.335040807724s
[]
mse:0.24676159024238586, mae:0.3284061849117279
	iters: 8800, cost time: 2183.8944754600525s
[]
mse:0.2455798238515854, mae:0.32770678400993347
	iters: 8900, cost time: 2207.679869890213s
[]
mse:0.24569110572338104, mae:0.32745665311813354
	iters: 9000, cost time: 2232.1688141822815s
[]
mse:0.24549470841884613, mae:0.3270801603794098
	iters: 9100, cost time: 2256.4072432518005s
[]
mse:0.2485773116350174, mae:0.32873111963272095
	iters: 9200, cost time: 2281.0159215927124s
[]
mse:0.25119248032569885, mae:0.33059602975845337
	iters: 9300, cost time: 2305.1676032543182s
[]
mse:0.25462543964385986, mae:0.3309032618999481
	iters: 9400, cost time: 2329.981942653656s
[]
mse:0.2576744854450226, mae:0.3323259949684143
	iters: 9500, cost time: 2354.2758514881134s
[]
mse:0.25957736372947693, mae:0.3334973156452179
	iters: 9600, cost time: 2377.805053472519s
[]
mse:0.26055943965911865, mae:0.33360061049461365
	iters: 9700, cost time: 2402.0275547504425s
[]
mse:0.2595968246459961, mae:0.3330451548099518
	iters: 9800, cost time: 2426.642195701599s
[]
mse:0.26098576188087463, mae:0.33346229791641235
	iters: 9900, cost time: 2452.0532460212708s
[]
mse:0.2625238001346588, mae:0.33393731713294983
	iters: 10000, cost time: 2477.1301164627075s
[]
mse:0.26385918259620667, mae:0.33465149998664856
	iters: 10100, cost time: 2502.383522748947s
[]
mse:0.26585444808006287, mae:0.3348998725414276
	iters: 10200, cost time: 2527.636817216873s
[]
mse:0.2656315267086029, mae:0.33468055725097656
	iters: 10300, cost time: 2552.4121799468994s
[]
mse:0.26414456963539124, mae:0.33374887704849243
	iters: 10400, cost time: 2578.2506878376007s
[]
mse:0.262951135635376, mae:0.33298778533935547
[0.18553568830123127, 0.19423809160238717, 0.1953421283687819, 0.19802747482965563, 0.2020043863418927, 0.20628165052541148, 0.21124843837615218, 0.2169185530907328, 0.22272439354352763, 0.2289366048670826, 0.2348915781680072, 0.23912194330837008, 0.24122305079669148, 0.24057555311201273, 0.23941479398530477, 0.2389254322669129, 0.2392194499744549, 0.24070214642659354, 0.24292496081527426, 0.24601806941157195, 0.24895557716213473, 0.25138203043698243, 0.2536246527359282, 0.2557813487057933, 0.2576437538709243, 0.2592670286764658, 0.2609018177435295, 0.26245855577957966, 0.26323825017931113, 0.2637597290460699, 0.26368809696516093, 0.26355714906227845, 0.2632623958791157, 0.26305658793328696, 0.26323466308202526, 0.2635294348941363, 0.2638411323153526, 0.2641257351989869, 0.26466253626584607, 0.26501420362855543, 0.2656647764994452, 0.2661466908582127, 0.26650724966142847, 0.2665729053978916, 0.26685989316299985, 0.26699113026160565, 0.2671486280102508, 0.2672244706163033, 0.2675501976197597, 0.267971861509343, 0.26829400581945473, 0.2687956103540073, 0.26937802946147743, 0.270086673533122, 0.27098709881413235, 0.27169716720579334, 0.27228699779427423, 0.2728769647188519, 0.27342888400411963, 0.27404959320856886, 0.2745663658977953, 0.27493924572628686, 0.2752953762098846, 0.27531847136592036, 0.27517387648280717, 0.2750031258926054, 0.27490096074284304, 0.2745065121245433, 0.27405157687326365, 0.27346549506863843, 0.273319589884396, 0.2734906075023648, 0.2734416695964412, 0.27299822347684705, 0.27284966036686276, 0.2731509711087779, 0.27367344208969296, 0.27409049562243293, 0.27475721607957077, 0.27556995791414296, 0.27656301704478103, 0.27756902490698276, 0.2781763551238199, 0.278746287148631, 0.27960601156248954, 0.28053184963580136, 0.2817027238802218, 0.2833836902905297, 0.2859626075726221, 0.28941560514282944, 0.29288873377094515, 0.29674425931652415, 0.30036335203046505, 0.3053238995546958, 0.3138809873466478, 0.31525389715724733]
test shape: (10444, 1, 96, 21) (10444, 1, 96, 21)
test shape: (10444, 96, 21) (10444, 96, 21)
mse:0.26229584217071533, mae:0.3325340151786804
Test - cost time: 2592.178104162216s
